import streamlit as st
import random
import time
from datetime import datetime

# ==============================================================================
# 1. ×”×’×“×¨×•×ª ××¢×¨×›×ª ×•×¢×™×¦×•×‘ (System & CSS)
# ==============================================================================

st.set_page_config(
    page_title="PICU Pro - ×”××¢×¨×›×ª ×”××œ××”",
    page_icon="ğŸ¥",
    layout="wide",
    initial_sidebar_state="expanded"
)

def render_clean_html(text):
    """
    ×× ×•×¢ ×¨×™× ×“×•×¨ ×˜×§×¡×˜ ×—×›× (V2):
    ××¤×¨×§ ××ª ×”×˜×§×¡×˜, ××–×”×” ×›×•×ª×¨×•×ª, ×‘×•×œ×˜×™× ×•×”×“×’×©×•×ª, ×•××™×™×¦×¨ HTML × ×§×™ ××™××™×Ÿ ×œ×©×××œ.
    ××•× ×¢ ××ª ×‘×¢×™×™×ª ×”'×›×•×›×‘×™×•×ª' ×•×”×˜×§×¡×˜ ×”×¦×¤×•×£.
    """
    if not text: return ""
    html = text.replace("\n", "<br>")
    lines = html.split("<br>")
    formatted = []
    in_list = False
    
    for line in lines:
        cl = line.strip()
        if not cl: continue
        
        # ×›×•×ª×¨×•×ª ×¨××©×™×•×ª (×¨××” 2)
        if cl.startswith("## "):
            if in_list: formatted.append("</ul>"); in_list = False
            clean = cl.replace("## ", "")
            cl = f"""
            <div style='background: #e3f2fd; padding: 15px; border-right: 6px solid #1565c0; border-radius: 8px; margin-top: 30px; margin-bottom: 20px;'>
                <h2 style='color: #0d47a1; margin: 0; font-size: 1.6rem; font-weight: 700;'>{clean}</h2>
            </div>
            """
        
        # ×›×•×ª×¨×•×ª ××©× ×” (×¨××” 3)
        elif cl.startswith("### "):
            if in_list: formatted.append("</ul>"); in_list = False
            clean = cl.replace("### ", "")
            cl = f"<h3 style='color: #0277bd; border-bottom: 2px solid #b3e5fc; margin-top: 25px; padding-bottom: 8px; font-weight: 600;'>{clean}</h3>"
            
        # ×˜×§×¡×˜ ××•×“×’×© (×›×•×ª×¨×•×ª ×¤× ×™××™×•×ª) - ××–×”×” ×©×•×¨×” ×©××ª×—×™×œ×” ×‘-**
        elif cl.startswith("**") and "**" in cl[2:]:
            parts = cl.split("**")
            # parts[1] ×”×•× ×”×‘×™×˜×•×™ ×”××•×“×’×©, parts[2] ×”×•× ×”×”××©×š
            if len(parts) >= 3:
                bold_text = parts[1]
                rest_text = "".join(parts[2:])
                cl = f"""
                <div style='margin-bottom: 12px; margin-top: 12px; line-height: 1.6;'>
                    <span style='color: #c62828; font-weight: 800; font-size: 1.05em; display: block;'>ğŸ“Œ {bold_text}</span>
                    <span style='color: #37474f;'>{rest_text}</span>
                </div>
                """
            else:
                cl = f"<div style='margin-bottom: 8px;'>{cl.replace('**', '')}</div>"

        # ×¨×©×™××•×ª (×‘×•×œ×˜×™×)
        elif cl.startswith("* ") or cl.startswith("- ") or cl.startswith("â—"):
            if not in_list: formatted.append("<ul style='margin-right: 20px; list-style-type: disc; color: #37474f;'>"); in_list = True
            content = cl.replace("* ", "").replace("- ", "").replace("â—", "")
            # ×”×“×’×©×” ×‘×ª×•×š ×©×•×¨×” ×‘×¨×©×™××”
            if "**" in content:
                parts = content.split("**")
                new_content = ""
                for i, p in enumerate(parts):
                    if i % 2 == 1: new_content += f"<span style='font-weight: 700; color: #000;'>{p}</span>"
                    else: new_content += p
                content = new_content
            
            cl = f"<li style='margin-bottom: 6px; line-height: 1.6;'>{content}</li>"
        
        # ×¡×ª× ×˜×§×¡×˜
        else:
            if in_list: formatted.append("</ul>"); in_list = False
            cl = f"<div style='margin-bottom: 8px; line-height: 1.6; color: #37474f;'>{cl}</div>"
            
        formatted.append(cl)
    
    if in_list: formatted.append("</ul>")
    return "".join(formatted)

# CSS ××ª×§×“×
st.markdown("""
<style>
    @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap');
    
    html, body, .stApp { font-family: 'Rubik', sans-serif !important; direction: rtl; text-align: right; background-color: #f1f5f9; }
    h1, h2, h3, h4, p, div, span, button, label, input { text-align: right !important; }
    
    /* ×›×¨×˜×™×¡×™×•×ª × ×™×•×•×˜ ×’×“×•×œ×•×ª ×•×™×¤×•×ª */
    .nav-card {
        background: white; border-radius: 16px; padding: 20px; text-align: center !important;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05); border-top: 6px solid #1976d2;
        transition: all 0.3s ease; cursor: pointer; height: 200px;
        display: flex; flex-direction: column; justify-content: center; align-items: center;
    }
    .nav-card:hover { transform: translateY(-8px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); border-color: #0d47a1; }
    .nav-icon { font-size: 3rem; margin-bottom: 15px; }
    .nav-title { font-size: 1.3rem; font-weight: 700; color: #1565c0; margin-bottom: 5px; }
    
    /* ×§×•×¤×¡×ª ×ª×•×›×Ÿ ×¨××©×™×ª */
    .content-container {
        background: white; padding: 50px; border-radius: 20px;
        box-shadow: 0 5px 25px rgba(0,0,0,0.05);
        border-right: 8px solid #1565c0; margin-bottom: 40px;
    }
    
    /* ×›×¤×ª×•×¨×™× */
    .stButton button { width: 100%; border-radius: 10px; font-weight: 600; padding: 12px; border: 1px solid #e0e0e0; background: white; transition:0.2s;}
    .stButton button:hover { background: #e3f2fd; border-color: #2196f3; color: #1565c0; }
    
    #MainMenu {visibility: hidden;} footer {visibility: hidden;}
</style>
""", unsafe_allow_html=True)

# ==============================================================================
# 2. ×”×× ×¦×™×§×œ×•×¤×“×™×” ×”×¨×¤×•××™×ª ×”××œ××” (FULL_DB) - ×—×œ×§ ×'
# ==============================================================================

FULL_DB = {
    "ğŸ’Š ×ª×¨×•×¤×•×ª ×•×¤×¨××§×•×œ×•×’×™×”": {
        "icon": "ğŸ’Š",
        "description": "××™× ×“×§×¡ ×ª×¨×•×¤×•×ª ××•×¨×—×‘: ×”×—×™×™××”, ×¡×“×¦×™×”, ××™× ×•×˜×¨×•×¤×™×, ×× ×˜×™×‘×™×•×˜×™×§×”, ××©×ª× ×™×, × ×•×’×“×™ ×¤×¨×›×•×¡.",
        "topics": {
            "××“× ×•×–×™×Ÿ (Adenosine)": {
                "text": """## ××“× ×•×–×™×Ÿ (Adenosine)
**×§×‘×•×¦×”:** × ×•×’×“×™ ×”×¤×¨×¢×•×ª ×§×¦×‘ (Anti-arrhythmic).
**×”×ª×•×•×™×”:** SVT (Supraventricular Tachycardia).

### ××•×¤×Ÿ ××ª×Ÿ (×“×’×© ×§×¨×™×˜×™!):
×–××Ÿ ××—×¦×™×ª ×”×—×™×™× ×©×œ ×”×ª×¨×•×¤×” ×”×•× ×©× ×™×•×ª ×‘×•×“×“×•×ª. ××ª×Ÿ ××™×˜×™ ×™×’×¨×•× ×œ×¤×™×¨×•×§ ×”×ª×¨×•×¤×” ×œ×¤× ×™ ×”×’×¢×ª×” ×œ×œ×‘.
**×—×•×‘×” ×œ×ª×ª ×‘×©×™×˜×ª Push-Flush:**
1. ×—×™×‘×•×¨ ×œ×‘×¨×– ×ª×œ×ª-×›×™×•×•× ×™ ×”×›×™ ×§×¨×•×‘ ×œ×•×•× ×¤×œ×•×Ÿ (×¨×¦×•×™ ×‘-AC).
2. ×”×–×¨×§×” ××”×™×¨×” ("×¤×•×©") ×©×œ ×”×ª×¨×•×¤×”.
3. ××™×“ ××—×¨×™×” ×”×–×¨×§×” ××”×™×¨×” ×©×œ ×¡×œ×™×™×Ÿ (5-10 ×"×œ).
4. ×”×¨××ª ×”×’×¤×”.

### ××™× ×•× ×™×:
* **×× ×” ×¨××©×•× ×”:** 0.1 ×"×’/×§"×’ (××§×¡×™××•× 6 ×"×’).
* **×× ×” ×©× ×™×”:** 0.2 ×"×’/×§"×’ (××§×¡×™××•× 12 ×"×’).
* **×× ×” ×©×œ×™×©×™×ª:** × ×™×ª×Ÿ ×œ×©×§×•×œ ×× ×” × ×•×¡×¤×ª ×‘××™× ×•×Ÿ 0.3 ×"×’/×§"×’ ××• ××¢×‘×¨ ×œ×ª×¨×•×¤×” ××—×¨×ª/×”×™×¤×•×š ×—×©××œ×™.

### ×ª×•×¤×¢×•×ª ×œ×•×•××™ ×•× ×™×˜×•×¨:
* ×ª×—×•×©×ª ×œ×—×¥ ×‘×—×–×” ("×‘×¢×™×˜×”"), ×”×¡××§×”, ×‘×—×™×œ×”.
* **×‘××•× ×™×˜×•×¨:** ××¡×™×¡×˜×•×œ×” (Asystole) ×¨×’×¢×™×ª ××• ×‘×¨×“×™×§×¨×“×™×” ×œ××—×¨ ×”××ª×Ÿ â€“ ×–×” ×ª×§×™×Ÿ ×•×¦×¤×•×™! ×™×© ×œ×”×›×™×Ÿ ×¢×’×œ×ª ×”×—×™×™××” ×‘×§×¨×‘×ª ××§×•×.""",
                "image": ""
            },
            "××“×¨× ×œ×™×Ÿ (Epinephrine)": {
                "text": """## ××“×¨× ×œ×™×Ÿ (Epinephrine)
**×§×‘×•×¦×”:** ×§×˜×›×•×œ×××™× ×™× (××œ×¤× + ×‘×˜× ××’×•× ×™×¡×˜).
**××™× ×“×™×§×¦×™×•×ª:** ×“×•× ×œ×‘, ×©×•×§, ×× ×¤×™×œ×§×¡×™×¡, ×‘×¨×•× ×›×•×¡×¤××–× ×§×©×”, ×¡×˜×¨×™×“×•×¨.

### ××™× ×•× ×™× ×•×¨×™×›×•×–×™× (×–×”×™×¨×•×ª! ×‘×œ×‘×•×œ ×”×•×¨×’):
×§×™×™××™× ×©× ×™ ×¨×™×›×•×–×™× ×¢×™×§×¨×™×™×. ×‘×œ×‘×•×œ ×‘×™× ×™×”× ××¡×•×›×Ÿ.

### 1. ×”×—×™×™××” (Cardiac Arrest)
* **×“×¨×š ××ª×Ÿ:** IV / IO.
* **×¨×™×›×•×–:** 1:10,000 (××“×•×œ×œ). ×›×œ×•××¨ 0.1 ×"×’ ×‘-1 ×"×œ.
* **××™× ×•×Ÿ:** **0.01 ×"×’/×§"×’** (×©×”× 0.1 ×"×œ/×§"×’ ××”×ª××™×¡×” ×”××“×•×œ×œ×ª).
* **××§×¡×™××•× ×œ×× ×”:** 1 ×"×’.
* **×ª×“×™×¨×•×ª:** ×›×œ 3-5 ×“×§×•×ª.

### 2. ×× ×¤×™×œ×§×¡×™×¡ (Anaphylaxis)
* **×“×¨×š ××ª×Ÿ:** IM (×©×¨×™×¨ ×”×™×¨×š).
* **×¨×™×›×•×–:** 1:1,000 (×œ× ××“×•×œ×œ).
* **××™× ×•×Ÿ:** **0.01 ×"×’/×§"×’**.
* **××§×¡×™××•× ×œ×× ×”:** 0.5 ×"×’ (×—×¦×™ ×××¤×•×œ×”).

### 3. ×“×¨×™×¤ ××ª××©×š (Inotrope)
* **×˜×•×•×— ××™× ×•× ×™×:** 0.05 - 1.0 ××™×§×¨×•×’×¨×/×§"×’/×“×§×”.
* **××™× ×•×Ÿ × ××•×š:** ×”×©×¤×¢×” ×‘×˜× (×—×™×–×•×§ ×›×™×•×•×¥ ×”×œ×‘).
* **××™× ×•×Ÿ ×’×‘×•×”:** ×”×©×¤×¢×” ××œ×¤× (×›×™×•×•×¥ ×›×œ×™ ×“× - ×”×¢×œ××ª ×œ×—×¥ ×“×).

### 4. ××™× ×”×œ×¦×™×” (×œ×¡×˜×¨×™×“×•×¨)
* **××™× ×•×Ÿ:** 0.5 ×"×œ/×§"×’ (××§×¡×™××•× 5 ×"×œ).""",
                "image": ""
            },
            "××©×œ×’×Ÿ (Potassium)": {
                "text": """## ××©×œ×’×Ÿ (K+)
**×¢×¨×›×™× ×ª×§×™× ×™×:** 3.5 - 5.0 mEq/L.

### ×”×™×¤×•×§×œ××™×” (Hypokalemia):
**×’×•×¨××™×:** ××©×ª× ×™× (×¤×•×¡×™×“), ×”×§××•×ª, ×©×œ×©×•×œ×™×, DKA (×‘×©×œ×‘ ×”×˜×™×¤×•×œ).
**×˜×™×¤×•×œ:**
* **××ª×Ÿ ×¤×•××™ (PO):** ×”×“×¨×š ×”××•×¢×“×¤×ª ×•×”×‘×˜×•×—×”.
* **××ª×Ÿ ×ª×•×š ×•×¨×™×“×™ (IV):**
  * ×¤×¨×™×¤×¨×™: ×¨×™×›×•×– ××§×¡×™××œ×™ 40 mEq/L. ×§×¦×‘ ××§×¡×™××œ×™ 0.5-1 mEq/kg/h. ×©×•×¨×£ ×‘×•×•×¨×™×“!
  * ××¨×›×–×™: × ×™×ª×Ÿ ×œ×ª×ª ×¨×™×›×•×–×™× ×’×‘×•×”×™× ×™×•×ª×¨ ×ª×—×ª × ×™×˜×•×¨ ×¦××•×“.
  
**×—×•×§ ×”×‘×¨×–×œ:**
×‘×—×•×œ×™× ×¢× ×”×™×¤×•×§×œ××™×” ×•×”×™×¤×•××’× ×–××™×” ××©×•×œ×‘×ª -> **×™×© ×œ×ª×§×Ÿ ××ª ×”××’× ×–×™×•× ×ª×—×™×œ×”!**
×—×•×¡×¨ ×‘××’× ×–×™×•× ××•× ×¢ ××”×›×œ×™×” ×œ×¡×¤×•×’ ××©×œ×’×Ÿ ×—×–×¨×”, ×•×”×”×™×¤×•×§×œ××™×” ×ª×”×™×” ×¢××™×“×” ×œ×˜×™×¤×•×œ.

### ×”×™×¤×¨×§×œ××™×” (Hyperkalemia):
××¦×‘ ××¡×›×Ÿ ×—×™×™× (×”×¤×¨×¢×•×ª ×§×¦×‘, VF).
**×˜×™×¤×•×œ ×—×™×¨×•×:**
1. **×§×œ×¦×™×•× ×’×œ×•×§×•× ×˜:** ×œ× ××•×¨×™×“ ××©×œ×’×Ÿ, ××š ××™×™×¦×‘ ××ª ×××‘×¨× ×ª ×”×œ×‘ (Cardioprotection).
2. **××™× ×¡×•×œ×™×Ÿ (0.1 ×™×—'/×§"×’) + ×’×œ×•×§×•×–:** ××›× ×™×¡ ××©×œ×’×Ÿ ×œ×ª××™×.
3. **×•× ×˜×•×œ×™×Ÿ (××™× ×”×œ×¦×™×”):** ××›× ×™×¡ ××©×œ×’×Ÿ ×œ×ª××™×.
4. **×¤×•×¡×™×“ / Kayexalate:** ×¤×™× ×•×™ ××©×œ×’×Ÿ ××”×’×•×£.""",
                "image": ""
            },
            "××™×¨×•×‘× ×˜ (Ipratropium)": {
                "text": """## ××™×¨×•×‘× ×˜ (Aerovent)
×× ×˜×™-×›×•×œ×™× ×¨×’×™. ××¨×—×™×‘ ×¡×™××¤×•× ×•×ª (×¡×™× ×¨×’×™×¡×˜×™ ×¢× ×•× ×˜×•×œ×™×Ÿ).
**××™× ×•×Ÿ:** 250 ××§"×’ (<20 ×§"×’) ××• 500 ××§"×’ (>20 ×§"×’).
**×ª×“×™×¨×•×ª:** ×›×œ 20 ×“×§×•×ª ×‘×”×ª×§×£ ×§×©×”.""", "image": ""},
            "×“×•×¤××™×Ÿ (Dopamine)": {
                "text": """## ×“×•×¤××™×Ÿ (Dopamine)
××™× ×•×˜×¨×•×¤. ×”×©×™××•×© ×‘×• ×¤×—×ª ×‘×©× ×™× ×”××—×¨×•× ×•×ª ×œ×˜×•×‘×ª ××“×¨× ×œ×™×Ÿ/× ×•×¨××“×¨× ×œ×™×Ÿ.
**××™× ×•× ×™×:**
* 2-5 ××§"×’/×§"×’/×“×§': "×›×œ×™×ª×™" (×œ× ×”×•×›×— ×›×™×¢×™×œ).
* 5-10 ××§"×’/×§"×’/×“×§': ×‘×˜× (×œ×‘×‘×™).
* 10-20 ××§"×’/×§"×’/×“×§': ××œ×¤× (×•×•×¡×§×•×œ×¨×™ - ××¢×œ×” ×œ"×“).""", "image": ""},
            "×“×§×¡××ª×•××™×“×™×Ÿ (Precedex)": {
                "text": """## ×“×§×¡××ª×•××™×“×™×Ÿ (Precedex)
××’×•× ×™×¡×˜ ××œ×¤×-2. ××¨×’×™×¢ (Sedative) ×•××©×›×š ×›××‘ ×§×œ.
**×™×ª×¨×•×Ÿ:** ×œ× ××“×›× × ×©×™××”! ×××¤×©×¨ ×’××™×œ×” ××× ×©×.
**××™× ×•×Ÿ:** 0.2-0.7 ××§"×’/×§"×’/×©×¢×”.
**×ª"×œ:** ×‘×¨×“×™×§×¨×“×™×”, ×™×¨×™×“×ª ×œ×—×¥ ×“×.""", "image": ""},
            "×•× ×˜×•×œ×™×Ÿ (Salbutamol)": {
                "text": """## ×•× ×˜×•×œ×™×Ÿ (Ventolin)
×‘×™×˜×-××’×•× ×™×¡×˜. ××¨×—×™×‘ ×¡×™××¤×•× ×•×ª.
**××™× ×•×Ÿ ××™× ×”×œ×¦×™×”:** 0.15 ×"×’/×§"×’ (××™× ×™××•× 2.5 ×"×’).
**×”×ª×§×£ ×§×©×”:** × ×™×ª×Ÿ ×œ×ª×ª ×‘×¨×¦×£ (Continuous Nebulization).
**IV:** ×‘××¦×‘×™ ×§×™×¦×•×Ÿ (××¡×˜××” ×§×©×”), ×‘×•×œ×•×¡ 10 ××§"×’/×§"×’ ×•××– ×“×¨×™×¤.
**×ª"×œ:** ×˜×›×™×§×¨×“×™×”, ×¨×¢×“, ×”×™×¤×•×§×œ××™×”.""", "image": ""},
            "××™×“×–×•×œ× (Dormicum)": {
                "text": """## ××™×“×–×•×œ× (Midazolam)
×‘× ×–×•×“×™××–×¤×™×Ÿ ×§×¦×¨ ×˜×•×•×—. ××©××© ×œ×”×¨×’×¢×” (Sedation), ×”×¤×¡×§×ª ×¤×¨×›×•×¡×™×, ×•×”×›× ×” ×œ×¤×¨×•×¦×“×•×¨×•×ª.
**××™× ×•× ×™×:**
* **IV (×¡×“×¦×™×”/×¤×¨×›×•×¡):** 0.1-0.2 ×"×’/×§"×’.
* **IM:** ××™× ×•×Ÿ 0.2 ×"×’/×§"×’.
* **×“×¨×™×¤ ××ª××©×š:** 1-5 ××§"×’/×§"×’/×“×§×”.
**×“×’×©×™×:** ×–×”×™×¨×•×ª ×‘×ª×™× ×•×§×•×ª < 6 ×—×•×“×©×™× (×“×™×›×•×™ × ×©×™××ª×™).""", "image": ""},
            "××•×¨×¤×™×Ÿ (Morphine)": {
                "text": """## ××•×¨×¤×™×Ÿ (Morphine)
××•×¤×™××˜ ×œ×©×™×›×•×š ×›××‘.
**××™× ×•×Ÿ:** 0.05-0.1 ×"×’/×§"×’ (IV/IM).
**×ª"×œ:** ×“×™×›×•×™ × ×©×™××ª×™, ×™×¨×™×“×ª ×œ"×“ (××©×—×¨×¨ ×”×™×¡×˜××™×Ÿ), ×’×¨×“, ×¢×¦×™×¨×•×ª.
**×× ×˜×™×“×•×˜:** × ×œ×•×§×¡×•×Ÿ (Narcan).""", "image": ""},
            "× ×•×¨××“×¨× ×œ×™×Ÿ (Norepinephrine)": {
                "text": """## × ×•×¨××“×¨× ×œ×™×Ÿ (Levophed)
××›×•×•×¥ ×›×œ×™ ×“× ×—×–×§ (××œ×¤× ××’×•× ×™×¡×˜). ×ª×¨×•×¤×ª ×”×‘×—×™×¨×” ×œ×©×•×§ ×¡×¤×˜×™ "×—×" (×•×–×•×“×™×œ×˜×•×¨×™).
**××™× ×•×Ÿ:** 0.05 - 1.0 ××§"×’/×§"×’/×“×§×”.
**××ª×Ÿ:** ×¨×¦×•×™ ×‘×•×¨×™×“ ××¨×›×–×™ (×¡×›× ×ª × ××§ ×‘×¤×¨×™×¤×¨×™).""", "image": ""},
            "×¤×•×¡×™×“ (Furosemide)": {
                "text": """## ×¤×•×¡×™×“ (Furosemide)
××©×ª×Ÿ ×œ×•×œ××”.
**××™× ×•×Ÿ:** 0.5-1 ×"×’/×§"×’ (IV/PO).
**×ª"×œ:** ×”×™×¤×•×§×œ××™×”, ×”×ª×™×™×‘×©×•×ª, ×¤×’×™×¢×” ×‘×©××™×¢×” (Ototoxicity) ×‘××ª×Ÿ ××”×™×¨ ×©×œ ××™× ×•×Ÿ ×’×‘×•×”.""", "image": ""},
            "×¤× ×™×˜×•××™×Ÿ (Phenytoin)": {
                "text": """## ×¤× ×™×˜×•××™×Ÿ (Epanutin)
×ª×¨×•×¤×” ×× ×˜×™-××¤×™×œ×¤×˜×™×ª (×§×• ×©× ×™ ×‘×¡×˜×˜×•×¡).
**×“×’×©×™ ×‘×˜×™×—×•×ª:**
1. **××™× ×•×Ÿ ×”×¢××¡×”:** 20 ×"×’/×§"×’.
2. **×”××¡×”:** ××š ×•×¨×§ ×‘-Normal Saline (0.9%).
   * **××¡×•×¨ ×œ×¢×¨×‘×‘ ×¢× ×’×œ×•×§×•×–!** (×’×•×¨× ×œ×”×ª×’×‘×©×•×ª ×•×©×§×™×¢×”).
3. **×¤×™×œ×˜×¨:** ×—×•×‘×” ×œ×”×©×ª××© ×‘×¡×˜ ×¢× ×¤×™×œ×˜×¨ 0.2 ××™×§×¨×•×Ÿ.
4. **×§×¦×‘:** ××™×˜×™! (××§×¡' 1 ×"×’/×§"×’/×“×§×”). ×¡×›× ×ª ×”×¤×¨×¢×•×ª ×§×¦×‘.""", "image": ""},
            "×§×˜××™×Ÿ (Ketamine)": {
                "text": """## ×§×˜××™×Ÿ (Ketamine)
×”×¨×“××” ×“×™×¡×•×¦×™××˜×™×‘×™×ª.
**×™×ª×¨×•× ×•×ª ×‘-PICU:**
* ×©×•××¨ ×¢×œ ×¨×¤×œ×§×¡ × ×©×™××”.
* ××¢×œ×” ×œ×—×¥ ×“× ×•×“×•×¤×§ (×¡×™××¤×˜×•××™××˜×™) - **××¦×•×™×Ÿ ×œ×©×•×§**.
* ××¨×—×™×‘ ×¡×™××¤×•× ×•×ª (×˜×•×‘ ×œ××¡×˜××”).
**××™× ×•× ×™×:**
* **××™× ×˜×•×‘×¦×™×”/×”×—×™×™××”:** 1-2 ×"×’/×§"×’ IV.
* **×¡×“×¦×™×”:** 1 ×"×’/×§"×’.
**×ª"×œ:** ×¨×™×•×¨ ××•×’×‘×¨ (×œ×ª×ª ××˜×¨×•×¤×™×Ÿ), ×”×–×™×•×ª ×‘×”×ª×¢×•×¨×¨×•×ª.""", "image": ""},
            "×¨×•×§×•×¨×•× ×™×•× (Esmeron)": {
                "text": """## ×¨×•×§×•×¨×•× ×™×•× (Rocuronium)
××©×ª×§ ×©×¨×™×¨×™× (Non-depolarizing).
**××™× ×•×Ÿ:** 1 ×"×’/×§"×’ (×œ××™× ×˜×•×‘×¦×™×” ××”×™×¨×” - RSI).
**×–××Ÿ ×”×©×¤×¢×”:** 30-40 ×©× ×™×•×ª.
**××–×”×¨×” ×—××•×¨×”:** ×—×•×‘×” ×œ×ª×ª ×¡×“×¦×™×” ×œ×¤× ×™ ×”××©×ª×§! (×”××˜×•×¤×œ ×¢×¨ ××š ××©×•×ª×§).""", "image": ""}
        }
    },
    "ğŸš‘ ××¦×‘×™ ×—×™×¨×•× ×•×”×—×™×™××”": {
        "icon": "ğŸš‘",
        "description": "×©×•×§, ×¡×¤×¡×™×¡, ×˜×¨××•××”, ×›×•×•×™×•×ª, ×”×¨×¢×œ×•×ª.",
        "topics": {
            "×©×•×§ ×”×™×¤×•×•×œ××™": {
                "text": """## ×©×•×§ ×”×™×¤×•×•×œ××™ / ×”××•×¨×’×™
**×”×’×“×¨×”:** ×¤×¨×¤×•×–×™×” ×œ×§×•×™×” ×¢×§×‘ ××•×‘×“×Ÿ × ×¤×— (×”×ª×™×™×‘×©×•×ª, ×“×™××•×, DKA).

### ×¡×™×× ×™× ×§×œ×™× ×™×™×:
* **×¤×™×¦×•×™:** ×˜×›×™×§×¨×“×™×”, ××™×œ×•×™ ×§×¤×™×œ×¨×™ > 2 ×©× ×™×•×ª. **×œ"×“ ×ª×§×™×Ÿ!**
* **×‘×œ×ª×™ ××¤×¦×”:** ×™×¨×™×“×ª ×œ×—×¥ ×“× (×¡×™××Ÿ ×××•×—×¨!), ×©×™× ×•×™ ×‘×”×›×¨×”, ××™×¢×•×˜ ×©×ª×Ÿ.

### ×˜×™×¤×•×œ:
1. **× ×ª×™×‘ ××•×•×™×¨:** ×—××¦×Ÿ 100%.
2. **× ×•×–×œ×™×:** ×‘×•×œ×•×¡ ×§×¨×™×¡×˜×œ×•××™×“×™× (×¡×œ×™×™×Ÿ/×”×¨×˜××Ÿ) **20 ×"×œ/×§"×’** ×ª×•×š 5-10 ×“×§×•×ª.
   * × ×™×ª×Ÿ ×œ×—×–×•×¨ ×¢×“ 3 ×¤×¢××™× (60 ×"×œ/×§"×’).
3. **×“×:** ×‘×©×•×§ ×”××•×¨×’×™ ×œ×œ× ×ª×’×•×‘×” ×œ× ×•×–×œ×™× -> ×× ×ª ×“× (PC) **10 ×"×œ/×§"×’**.""",
                "image": "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/Capillary_refill.gif/220px-Capillary_refill.gif"
            },
            "×©×•×§ ×¡×¤×˜×™": {
                "text": """## ×¡×¤×¡×™×¡ ×•×©×•×§ ×¡×¤×˜×™
**×”×’×“×¨×”:** ×–×™×”×•× + SIRS.
**×—×‘×™×œ×ª ×”×˜×™×¤×•×œ (Golden Hour):**
1. **×’×™×©×” ×•×¨×™×“×™×ª:** ×ª×•×š ×“×§×•×ª.
2. **×ª×¨×‘×™×•×ª:** ×œ×¤× ×™ ×× ×˜×™×‘×™×•×˜×™×§×” (××œ× ×× ××¢×›×‘).
3. **×× ×˜×™×‘×™×•×˜×™×§×”:** ×¨×—×‘×ª ×˜×•×•×— (××¨×•×¤× ×) **×ª×•×š ×©×¢×”!**
4. **× ×•×–×œ×™×:** 20-60 ×"×œ/×§"×’.
5. **××™× ×•×˜×¨×•×¤×™×:**
   * **×©×•×§ ×§×¨:** ××“×¨× ×œ×™×Ÿ.
   * **×©×•×§ ×—×:** × ×•×¨××“×¨× ×œ×™×Ÿ.""",
                "image": ""
            },
            "×× ×¤×™×œ×§×¡×™×¡": {
                "text": """## ×× ×¤×™×œ×§×¡×™×¡
**×˜×™×¤×•×œ ××™×™×“×™:**
1. **××“×¨× ×œ×™×Ÿ IM:** ××™× ×•×Ÿ 0.01 ×"×’/×§"×’ (1:1000). ×‘×™×¨×š.
2. **× ×•×–×œ×™×:** ×‘×•×œ×•×¡ 20 ×"×œ/×§"×’.
3. **× ×ª×™×‘ ××•×•×™×¨:** ××™× ×˜×•×‘×¦×™×” ××•×§×“××ª ×× ×™×© ×¡×˜×¨×™×“×•×¨.""",
                "image": ""
            },
            "×›×•×•×™×•×ª (Burns)": {
                "text": """## ×›×•×•×™×•×ª ×•× ×•×¡×—×ª ×¤×¨×§×œ× ×“
**×—×™×©×•×‘ × ×•×–×œ×™×:** `4 ×"×œ * ××©×§×œ * % ×›×•×•×™×”`.
* 50% ×‘-8 ×©×¢×•×ª ×¨××©×•× ×•×ª.
* 50% ×‘-16 ×”×‘××•×ª.
* **×™×œ×“×™×:** ×œ×”×•×¡×™×£ × ×•×–×œ×™ ××—×–×§×” (Maintenance) ×¢× ×¡×•×›×¨!
**×©××™×¤×ª ×¢×©×Ÿ:** ××™× ×˜×•×‘×¦×™×” ××•×§×“××ª.""",
                "image": ""
            },
            "×”×›×©×•×ª × ×—×©": {
                "text": """## ×”×›×©×ª × ×—×© (×¦×¤×¢)
**×˜×™×¤×•×œ:**
1. ×× ×•×—×” ×•×§×™×‘×•×¢ ×”×’×¤×”.
2. **××¡×•×¨:** ×œ××¦×•×¥, ×œ×—×ª×•×š, ×œ×©×™× ×—×¡× ×¢×•×¨×§×™×, ×œ×§×¨×¨.
3. ×¡×™××•×Ÿ ×’×‘×•×œ ×”× ×¤×™×—×•×ª.
4. **×× ×˜×™-×¡×¨×•×:** ×‘×”×ª×¤×©×˜×•×ª ××”×™×¨×” ××• ×¡×™×× ×™ ×©×•×§.""",
                "image": ""
            },
            "×”×¨×¢×œ×•×ª": {
                "text": """## ×”×¨×¢×œ×•×ª × ×¤×•×¦×•×ª
**××§××•×œ:** ×¤×’×™×¢×” ×›×‘×“×™×ª. ×× ×˜×™×“×•×˜: **NAC (Mucomyst)**.
**××•×¤×™××˜×™×:** ×§×•××”, ××™×©×•× ×™ ×¡×™×›×”. ×× ×˜×™×“×•×˜: **× ×œ×•×§×¡×•×Ÿ**.
**×–×¨×—× ×™× ××•×¨×’× ×™×™×:** ×¨×™×•×¨, ×“××¢×ª, ×‘×¨×“×™×§×¨×“×™×”. ×˜×™×¤×•×œ: **××˜×¨×•×¤×™×Ÿ**.""",
                "image": ""
            }
        }
    }
}
# ==============================================================================
# ×”××©×š ××¡×“ ×”× ×ª×•× ×™× (FULL_DB Part 2)
# ==============================================================================

FULL_DB.update({
    "ğŸ§  × ×•×™×¨×•×œ×•×’×™×”": {
        "icon": "ğŸ§ ",
        "description": "TBI, ×’×œ×–×’×•, ICP, ×¤×¨×›×•×¡×™×, ×× ×™× ×’×™×˜×™×¡, ADEM, ×”×™×“×¨×•×¦×¤×œ×•×¡.",
        "topics": {
            "×—×‘×œ×ª ×¨××© (TBI)": {
                "text": """## ×—×‘×œ×ª ×¨××© (TBI)
**×™×¢×“:** ×©××™×¨×” ×¢×œ CPP (×œ×—×¥ ×–×™×œ×•×— ××•×—×™) ×ª×§×™×Ÿ.
`CPP = MAP - ICP`

### ×œ×—×¥ ×ª×•×š ×’×•×œ×’×•×œ×ª×™ (ICP):
* **Cushing Triad:** ×™×ª×¨ ×œ×—×¥ ×“×, ×‘×¨×“×™×§×¨×“×™×”, × ×©×™××” ×œ× ×¡×“×™×¨×”. (×¡×™××Ÿ ×œ×”×¨× ×™××¦×™×”).
* **×˜×™×¤×•×œ ×‘-ICP ××•×’×‘×¨:**
  1. ×”×¨××ª ×¨××© 30 ××¢×œ×•×ª (× ×™×§×•×– ×•×¨×™×“×™).
  2. **×¡×œ×™×™×Ÿ ×”×™×¤×¨×˜×•× ×™ 3%:** 3-5 ×"×œ/×§"×’.
  3. **×× ×™×˜×•×œ:** 0.5-1 ×’×¨×/×§"×’ (×× ××•×¡××•×œ×¨×™×•×ª < 320).
  4. ×”×™×¤×¨×•×•× ×˜×™×œ×¦×™×” ××ª×•× ×” (PCO2 30-35) - ×¨×§ ×‘××¦×‘ ×—×™×¨×•× ×§×™×¦×•× ×™.""",
                "image": ""
            },
            "×¡×˜×˜×•×¡ ××¤×™×œ×¤×˜×™×§×•×¡": {
                "text": """## ×¡×˜×˜×•×¡ ××¤×™×œ×¤×˜×™×§×•×¡
×¤×¨×›×•×¡ ×”× ××©×š ××¢×œ 5 ×“×§×•×ª.

### ×¤×¨×•×˜×•×§×•×œ ×˜×™×¤×•×œ:
1. **ABC:** ×—××¦×Ÿ, ×‘×“×™×§×ª ×¡×•×›×¨ (×œ×©×œ×•×œ ×”×™×¤×•×’×œ×™×§××™×”).
2. **×§×• ×¨××©×•×Ÿ (××™×™×“×™):** ××™×“×–×•×œ× 0.1-0.2 ×"×’/×§"×’ IV/IM.
3. **×§×• ×©× ×™ (×”×¢××¡×”):**
   * ×¤× ×™×˜×•××™×Ÿ (×‘×¡×œ×™×™×Ÿ ×‘×œ×‘×“!).
   * ×§×¤×¨×” (Levetiracetam) - ×‘×˜×•×—×” ×™×—×¡×™×ª.
   * ×¤× ×•×‘×¨×‘×™×˜×œ (×‘×ª×™× ×•×§×•×ª).
4. **×§×• ×©×œ×™×©×™ (×”×¨×“××”):** ××™×“×–×•×œ× ×“×¨×™×¤, ×¤×¨×•×¤×•×¤×•×œ, ×ª×™×•×¤× ×˜×œ.""",
                "image": ""
            },
            "×× ×™× ×’×™×˜×™×¡": {
                "text": """## ×“×œ×§×ª ×§×¨×•× ×”××•×— (Meningitis)
**×¡×™×× ×™×:** ×—×•×, ×§×©×™×•×Ÿ ×¢×•×¨×£, ×¤×•×˜×•×¤×•×‘×™×”, ×¤×˜×›×™×•×ª (×× ×™× ×’×•×§×•×§).
**××‘×—× ×”:** LP (× ×™×§×•×¨ ××•×ª× ×™). *×§×•× ×˜×¨××™× ×“×™×§×¦×™×”: ICP ××•×’×‘×¨*.
**×˜×™×¤×•×œ:** ×¨×•×¦×¤×™×Ÿ (100 ×"×’/×§"×’/×™×•×) + ×•×× ×§×•××™×¦×™×Ÿ.
**×‘×™×“×•×“:** ××’×¢ + × ×©×™××ª×™.""",
                "image": ""
            },
            "DI vs SIADH": {
                "text": """## ×××–×Ÿ ××œ×—×™× ××•×—×™ (Sodium)
**Diabetes Insipidus (DI):**
* **×× ×’× ×•×Ÿ:** ×—×¡×¨ ×‘-ADH.
* **×¡×™×× ×™×:** ×”×©×ª× ×” ××¨×•×‘×” ×•×‘×”×™×¨×”, **×”×™×¤×¨× ×ª×¨××™×”** ×‘×“×.
* **×˜×™×¤×•×œ:** × ×•×–×œ×™× ×—×•×¤×©×™×™×, DDAVP.

**SIADH:**
* **×× ×’× ×•×Ÿ:** ×¢×•×“×£ ADH.
* **×¡×™×× ×™×:** ××™×¢×•×˜ ×©×ª×Ÿ ××¨×•×›×–, **×”×™×¤×•× ×ª×¨××™×”** (×“×™×œ×•×œ).
* **×˜×™×¤×•×œ:** ×”×’×‘×œ×ª × ×•×–×œ×™×, ××œ×— ×”×™×¤×¨×˜×•× ×™.""",
                "image": ""
            },
            "×”×™×“×¨×•×¦×¤×œ×•×¡ ×•×©× ×˜": {
                "text": """## ×”×™×“×¨×•×¦×¤×œ×•×¡ ×•-VP Shunt
×”×¦×˜×‘×¨×•×ª CSF ×‘×—×“×¨×™ ×”××•×—.
**Shunt Malfunction:**
* ×¡×™×× ×™×: ×”×§××•×ª, ×™×©× ×•× ×™×•×ª, ×©×§×™×¢×ª ×©××© ×‘×¢×™× ×™×™× (Sunset eyes).
* ×‘×™×¨×•×¨: CT ×¨××© (×”×©×•×•××” ×œ×§×•×“×), ×¦×™×œ×•× ×©× ×˜ (Shunt Series).
* ×˜×™×¤×•×œ: ×›×™×¨×•×¨×’×™.""",
                "image": ""
            }
        }
    },
    "ğŸ©¸ ×”××˜×•-××•× ×§×•×œ×•×’×™×”": {
        "icon": "ğŸ©¸",
        "description": "×œ×•×§××™×”, TLS, ××•×¦×¨×™ ×“×, ×× ××™×” ××¤×œ×¡×˜×™×ª.",
        "topics": {
            "×œ×•×§××™×” ×•× ×•×™×˜×¨×•×¤× ×™×”": {
                "text": """## ×—×•× ×•× ×•×™×˜×¨×•×¤× ×™×”
**×”×’×“×¨×”:** ×—×•× ×‘×—×•×œ×” ×¢× ×¡×¤×™×¨×ª × ×•×™×˜×¨×•×¤×™×œ×™× × ××•×›×” (<500).
**×¡×›× ×”:** ×¡×¤×¡×™×¡ ××—×™×™×“×§×™× ××•×¤×•×¨×˜×•× ×™×¡×˜×™× (×›×’×•×Ÿ Pseudomonas).
**×˜×™×¤×•×œ:** ×× ×˜×™×‘×™×•×˜×™×§×” ×¨×—×‘×ª ×˜×•×•×— (×¦×¤×˜×–×™×“×™×/××¨×•×¤× ×) **×ª×•×š ×©×¢×”!**""",
                "image": ""
            },
            "TLS (×ª×¡××•× ×ª ×¤×™×¨×•×§ ×’×™×“×•×œ)": {
                "text": """## Tumor Lysis Syndrome (TLS)
×¤×™×¨×•×§ ××¡×™×‘×™ ×©×œ ×ª××™ ×’×™×“×•×œ (×œ×•×§××™×”/×œ×™××¤×•××”).
**××¢×‘×“×”:** ×”×™×¤×¨-××•×¨×™×¦××™×”, ×”×™×¤×¨-×§×œ××™×”, ×”×™×¤×¨-×¤×•×¡×¤×˜××™×” -> ×”×™×¤×•×§×œ×¦××™×”.
**×¡×›× ×•×ª:** ×›×©×œ ×›×œ×™×ª×™ (×©×™×§×•×¢ ×—×•××¦×” ××•×¨×™×ª), ×“×•× ×œ×‘ (××©×œ×’×Ÿ).
**×˜×™×¤×•×œ:**
1. ×”×™×“×¨×¦×™×” (×¤×™ 2-3). ×œ×œ× ××©×œ×’×Ÿ!
2. ××œ×•×¤×¨×™× ×•×œ.
3. **Rasburicase:** ××¤×¨×§ ×—×•××¦×” ××•×¨×™×ª. **××¡×•×¨ ×‘×—×•×œ×™ G6PD!**""",
                "image": ""
            },
            "××•×¦×¨×™ ×“×": {
                "text": """## ××ª×Ÿ ××•×¦×¨×™ ×“×
**PC (×›×“×•×¨×™×•×ª):** 10-15 ×"×œ/×§"×’. ×—×•×‘×” ×¤×™×œ×˜×¨.
**×˜×¡×™×•×ª (Platelets):** 5-10 ×"×œ/×§"×’.
* **××–×”×¨×”:** ××¡×•×¨ ×œ×ª×ª ×‘××©××‘×” (IVAC)! ×”×× ×’× ×•×Ÿ ×”×•×¨×¡ ××ª ×”×˜×¡×™×•×ª. ×œ×ª×ª ×‘×’×¨×‘×™×˜×¦×™×”.
**×¤×œ×–××” (FFP):** ×œ×”×¤×¨×¢×•×ª ×§×¨×™×©×”/×“×™××•×.
**×”×§×¨× ×”:** ×—×•×‘×” ×œ××“×•×›××™ ×—×™×¡×•×Ÿ (×œ×× ×™×¢×ª GVHD).""",
                "image": ""
            },
            "×× ××™×” ××¤×œ×¡×˜×™×ª": {
                "text": """## ×× ××™×” ××¤×œ×¡×˜×™×ª
×›×©×œ ×©×œ ××— ×”×¢×¦× (×™×¨×™×“×” ×‘×›×œ ×”×©×•×¨×•×ª).
**×˜×™×¤×•×œ:** ×ª××™×›×” ×‘×“×, ××™××•× ×•×¡×•×¤×¨×¡×™×” (ATG), ×”×©×ª×œ×ª ××— ×¢×¦×.""",
                "image": ""
            }
        }
    },
    "ğŸ ×’×¡×˜×¨×• ×•××˜×‘×•×œ×™": {
        "icon": "ğŸ",
        "description": "TPN, ×›×‘×“, ××—×œ×•×ª ××˜×‘×•×œ×™×•×ª, FTT.",
        "topics": {
            "TPN ×•×”×–× ×”": {
                "text": """## TPN (×”×–× ×” ×ª×•×š ×•×¨×™×“×™×ª)
**×¡×™×‘×•×›×™×:**
1. ×–×™×”×•× ×¦× ×ª×¨ (CLABSI).
2. ×”×¤×¨×¢×•×ª ××˜×‘×•×œ×™×•×ª.
3. **Refeeding Syndrome:** ×‘×™×œ×“×™× ×‘×ª×ª-×ª×–×•× ×”. × ×¤×™×œ×” ×—×“×” ×©×œ ×–×¨×—×Ÿ, ××©×œ×’×Ÿ ×•××’× ×–×™×•× ×¢× ×”×ª×—×œ×ª ×”×”×–× ×”. ×¡×›× ×ª ×—×™×™×!""",
                "image": ""
            },
            "××™ ×¡×¤×™×§×ª ×›×‘×“": {
                "text": """## ××™ ×¡×¤×™×§×ª ×›×‘×“ ×—×¨×™×¤×”
**×¡×™×× ×™×:** ×¦×”×‘×ª, INR ×’×‘×•×” (×œ×œ× ×ª×™×§×•×Ÿ ×¢× ×•×™×˜××™×Ÿ K), ×× ×¦×¤×œ×•×¤×ª×™×” (×××•× ×™×” ×’×‘×•×”×”).
**×˜×™×¤×•×œ:**
* ×ª×™×§×•×Ÿ ×§×¨×™×©×” (×¤×œ×–××”).
* ×× ×™×¢×ª ×‘×¦×§×ª ××•×—×™×ª (×”×¨××ª ×¨××©, × ×ª×¨×Ÿ).
* ×©××™×¨×” ×¢×œ ×¡×•×›×¨ (×¡×›× ×ª ×”×™×¤×•×’×œ×™×§××™×”).""",
                "image": ""
            },
            "××—×œ×•×ª ××˜×‘×•×œ×™×•×ª": {
                "text": """## ××©×‘×¨ ××˜×‘×•×œ×™ (Metabolic Crisis)
×™×œ×“ ×”××’×™×¢ ×‘×©×•×§/×§×•××” ×œ×œ× ×¡×™×‘×” ×‘×¨×•×¨×”.
**×—×©×“:** ×—××¦×ª ××˜×‘×•×œ×™×ª, ×”×™×¤×•×’×œ×™×§××™×”, ×××•× ×™×” ×’×‘×•×”×”.
**×˜×™×¤×•×œ:** ×”×¤×¡×§×ª ×›×œ×›×œ×” (×—×œ×‘×•×Ÿ), ××ª×Ÿ ×’×œ×•×§×•×– ×‘××™× ×•×Ÿ ×’×‘×•×” (×× ×™×¢×ª ×§×˜×‘×•×œ×™×–×).""",
                "image": ""
            },
            "×“×™××•× ×¢×™×›×•×œ": {
                "text": """## ×“×™××•× ××“×¨×›×™ ×”×¢×™×›×•×œ
**×¢×œ×™×•×Ÿ:** ×”××˜××–×™×¡/××œ× ×”.
**×ª×—×ª×•×Ÿ:** ×”××˜×•×›×–×™×”.
**×˜×™×¤×•×œ:** ×–×•× ×“×” (×©×˜×™×¤×”), × ×•×–×œ×™×/×“×, PPI, ××•×§×˜×¨×™××•×˜×™×“ (×œ×“×œ×™×•×ª).""",
                "image": ""
            }
        }
    },
    "ğŸ« × ×©×™××” ×•×”× ×©××”": {
        "icon": "ğŸ«",
        "description": "××¡×˜××”, ×‘×¨×•× ×›×™×•×œ×™×˜×™×¡, ARDS, ×”× ×©××”.",
        "topics": {
            "×¡×˜×˜×•×¡ ××¡×˜××ª×™": {
                "text": """## ×¡×˜×˜×•×¡ ××¡×˜××ª×™
×”×ª×§×£ ×§×©×” ×©×œ× ××’×™×‘ ×œ×˜×™×¤×•×œ ×¨×’×™×œ.
**×˜×™×¤×•×œ ××“×•×¨×’:**
1. ×—××¦×Ÿ.
2. ××™× ×”×œ×¦×™×•×ª ×¨×¦×•×¤×•×ª (×•× ×˜×•×œ×™×Ÿ+××™×¨×•×‘× ×˜).
3. ×¡×˜×¨×•××™×“×™× IV.
4. ××’× ×–×™×•× ×¡×•×œ×¤×˜ IV.
5. ××™× ×˜×•×‘×¦×™×” (×¢× ×§×˜××™×Ÿ).""",
                "image": ""
            },
            "×‘×¨×•× ×›×™×•×œ×™×˜×™×¡": {
                "text": """## ×‘×¨×•× ×›×™×•×œ×™×˜×™×¡ (RSV)
×“×œ×§×ª ×‘×“×¨×›×™ ××•×•×™×¨ ×§×˜× ×•×ª ×‘×ª×™× ×•×§×•×ª.
**×˜×™×¤×•×œ:** ×ª×•××š! (×—××¦×Ÿ, ×©××™×‘×ª ×”×¤×¨×©×•×ª).
* **High Flow:** ×™×¢×™×œ ×××•×“.
* ××™× ×”×œ×¦×™×•×ª/×× ×˜×™×‘×™×•×˜×™×§×” ×œ×¨×•×‘ ××™× ×Ÿ ×™×¢×™×œ×•×ª.""",
                "image": ""
            },
            "ARDS": {
                "text": """## ARDS ×‘×™×œ×“×™×
×›×©×œ × ×©×™××ª×™ ×¢× ×¤×’×™×¢×” ×¨×™××ª×™×ª.
**×¢×§×¨×•× ×•×ª ×”× ×©××”:**
* × ×¤×—×™× × ××•×›×™× (4-6 ×"×œ/×§"×’) ×œ×”×’× ×” ×¢×œ ×”×¨×™××”.
* PEEP ×’×‘×•×”.
* ×©×›×™×‘×” ×¢×œ ×”×‘×˜×Ÿ (Prone) ×‘××§×¨×™× ×§×©×™×.""",
                "image": ""
            }
        }
    },
    "ğŸ’‰ ×¦× ×ª×¨×™× ×•×¤×¨×•×¦×“×•×¨×•×ª": {
        "icon": "ğŸ’‰",
        "description": "×¡×•×’×™ ×¦× ×ª×¨×™×, ×”×—×œ×¤×ª ×—×‘×™×©×”, ×”×™×§××Ÿ/×¤×•×¨×˜.",
        "topics": {
            "×¡×•×’×™ ×¦× ×ª×¨×™× ××¨×›×–×™×™×": {
                "text": """## ×¦× ×ª×¨×™× ××¨×›×–×™×™×
**CVC:** ×œ×˜×•×•×— ×§×¦×¨. ×’'×•×’×•×œ×¨/×¡××‘×§×œ××‘×™××Ÿ.
**PICC:** ××•×—×“×¨ ××•×¨×™×“ ×¤×¨×™×¤×¨×™ ×œ×•×¨×™×“ ××¨×›×–×™. ×˜×•×•×— ×‘×™× ×•× ×™-××¨×•×š.
**Hickman:** ×¢× ×ª×¢×œ×” ×ª×ª-×¢×•×¨×™×ª (Tunnelled). ×œ×˜×•×•×— ××¨×•×š.
**Port-a-Cath:** ××•×©×ª×œ ×ª×ª-×¢×•×¨×™. ×œ××•× ×§×•×œ×•×’×™×”.""",
                "image": ""
            },
            "×ª×—×–×•×§×ª ×¦× ×ª×¨": {
                "text": """## ×ª×—×–×•×§×” ×•×× ×™×¢×ª ×–×™×”×•×
* ×”×—×œ×¤×ª ×—×‘×™×©×” ×¡×˜×¨×™×œ×™×ª (×›×œ 7 ×™××™× ×œ×©×§×•×¤×”, 48 ×©×¢×•×ª ×œ×’×–×”).
* ×©×˜×™×¤×•×ª ×”×¤×¨×™×Ÿ (×œ×× ×™×¢×ª ×—×¡×™××”).
* **CLABSI:** ×–×™×”×•× ×‘×“× ×”×§×©×•×¨ ×œ×¦× ×ª×¨. ××—×™×™×‘ ×œ×§×™×—×ª ×ª×¨×‘×™×•×ª ××”×œ×™×™×Ÿ ×•××¤×¨×™×¤×¨×™×”.""",
                "image": ""
            }
        }
    }
})
# ==============================================================================
# 3. ×××’×¨ ×©××œ×•×ª ×•×¡×™××•×œ×˜×•×¨
# ==============================================================================

ALL_QUESTIONS = [
    {"q": "××” ×”××™× ×•×Ÿ ×©×œ ××“×¨× ×œ×™×Ÿ IV ×‘×”×—×™×™××”?", "opts": ["0.01 ×\"×’/×§\"×’ (1:10,000)", "0.1 ×\"×’/×§\"×’", "1 ×\"×’/×§\"×’", "0.5 ×\"×’"], "a": "0.01 ×\"×’/×§\"×’ (1:10,000)", "exp": "×“×™×œ×•×œ 1:10,000."},
    {"q": "×‘××™×–×” ×ª××™×¡×” ××“×œ×œ×™× ×¤× ×™×˜×•××™×Ÿ?", "opts": ["×¡×œ×™×™×Ÿ (NS)", "×’×œ×•×§×•×– 5%", "××™× ××–×•×§×§×™×", "×”×¨×˜××Ÿ"], "a": "×¡×œ×™×™×Ÿ (NS)", "exp": "×©×•×§×¢ ×‘×’×œ×•×§×•×–."},
    {"q": "×˜×™×¤×•×œ ×¨××©×•×Ÿ ×‘×× ×¤×™×œ×§×¡×™×¡?", "opts": ["××“×¨× ×œ×™×Ÿ IM", "×¡×˜×¨×•××™×“×™×", "×•× ×˜×•×œ×™×Ÿ", "×× ×˜×™×‘×™×•×˜×™×§×”"], "a": "××“×¨× ×œ×™×Ÿ IM", "exp": "××¦×™×œ ×—×™×™×."},
    {"q": "×ª×¨×•×¤×” ××¡×•×¨×” ×‘-TLS ×¢× G6PD?", "opts": ["Rasburicase", "Allopurinol", "Furosemide", "Calcium"], "a": "Rasburicase", "exp": "×’×•×¨××ª ×œ×”××•×œ×™×–×”."},
    {"q": "××”×• ×”×˜×™×¤×•×œ ×”××™×™×“×™ ×‘×”×¨× ×™××¦×™×” ××•×—×™×ª (Cushing)?", "opts": ["×¡×œ×™×™×Ÿ ×”×™×¤×¨×˜×•× ×™ 3%", "×”×•×¨×“×ª ×¨××©", "××ª×Ÿ × ×•×–×œ×™×", "×—×™××•×"], "a": "×¡×œ×™×™×Ÿ ×”×™×¤×¨×˜×•× ×™ 3%", "exp": "××•×¨×™×“ ICP ×‘××”×™×¨×•×ª."},
    {"q": "× ×•×¡×—×ª ×¤×¨×§×œ× ×“ ×œ×›×•×•×™×•×ª:", "opts": ["4 ×\"×œ * ×§\"×’ * % ×›×•×•×™×”", "2 ×\"×œ * ×§\"×’", "100 ×\"×œ/×§\"×’", "×œ×¤×™ ×’×™×œ"], "a": "4 ×\"×œ * ×§\"×’ * % ×›×•×•×™×”", "exp": "× ×•×–×œ×™× ×œ-24 ×©×¢×•×ª."},
    {"q": "××“×•×¢ ××¡×•×¨ ×œ×ª×ª ×˜×¡×™×•×ª ×‘××©××‘×” (IVAC)?", "opts": ["×”×¨×¡ ××›×× ×™", "×–×™×”×•×", "××”×™×¨ ××“×™", "×§×¨×™×©×”"], "a": "×”×¨×¡ ××›×× ×™", "exp": "×™×© ×œ×ª×ª ×‘×’×¨×‘×™×˜×¦×™×”."},
    {"q": "×¡×™××Ÿ ×œ-Diabetes Insipidus:", "opts": ["×©×ª×Ÿ ××¨×•×‘×”, ×”×™×¤×¨× ×ª×¨××™×”", "××™×¢×•×˜ ×©×ª×Ÿ, ×”×™×¤×•× ×ª×¨××™×”", "×¡×•×›×¨ ×’×‘×•×”", "×—×•×"], "a": "×©×ª×Ÿ ××¨×•×‘×”, ×”×™×¤×¨× ×ª×¨××™×”", "exp": "×—×¡×¨ ADH."}
]

class SimEngine:
    def __init__(self):
        self.reset()
    def reset(self):
        self.step = 0
        self.score = 100
        self.log = []
        self.dead = False
        self.data = [
            ("×™×œ×“ ×‘×Ÿ 4, ×”×’×™×¢ ×¢× ×—×•× ×•×§×•×¦×¨ × ×©×™××”. ×‘×‘×“×™×§×”: ×—×™×•×•×¨, ××™×œ×•×™ ×§×¤×™×œ×¨×™ 4 ×©× ×™×•×ª. ×“×•×¤×§ 160.",
             {"HR": 160, "BP": "90/50", "Sat": "92%"},
             [("×—××¦×Ÿ, ×•×¨×™×“, × ×•×–×œ×™× 20 ×\"×œ/×§\"×’", 10, "âœ… ×”×ª×—×œ×” ××¦×•×™× ×ª."), ("××§××•×œ ×•× ×™×˜×•×¨", -10, "âš ï¸ ×œ× ××¡×¤×™×§."), ("××™× ×˜×•×‘×¦×™×” ××™×™×“×™×ª", -30, "ğŸ’€ ××¡×•×›×Ÿ!"), ("×× ×˜×™×‘×™×•×˜×™×§×” ×‘×œ×‘×“", -5, "âš ï¸ ×¦×¨×™×š ×’× × ×•×–×œ×™×.")]),
            ("××—×¨×™ ×”× ×•×–×œ×™×: ×“×•×¤×§ 150. ×œ\"×“ ×™×¨×“ ×œ-80/40. ×”×›×¨×” ×™×¨×•×“×”. ×œ×§×˜×˜ 4.5.",
             {"HR": 150, "BP": "80/40", "Sat": "93%"},
             [("×‘×•×œ×•×¡ × ×•×¡×£ + ×× ×˜×™×‘×™×•×˜×™×§×”", 10, "âœ… ×˜×™×¤×•×œ × ×›×•×Ÿ ×‘×¡×¤×¡×™×¡."), ("×¤×•×¡×™×“", -50, "ğŸ’€ ×™×”×¨×•×’ ××•×ª×•!"), ("CT ×¨××©", -20, "âŒ ×œ× ×™×¦×™×‘."), ("×¨×§ ×× ×˜×™×‘×™×•×˜×™×§×”", -5, "âš ï¸ ×¦×¨×™×š ×¢×•×“ × ×¤×—.")]),
            ("× ×©×™××” ×××•××¦×ª (60 ×œ×“×§×”). ×¡×˜×•×¨×¦×™×” 88% ×¢× ×—××¦×Ÿ.",
             {"HR": 160, "BP": "75/35", "Sat": "88%"},
             [("××™× ×˜×•×‘×¦×™×” (RSI) ×¢× ×§×˜××™×Ÿ", 10, "âœ… ××™× ×“×™×§×¦×™×” ×œ×”× ×©××”."), ("××™× ×˜×•×‘×¦×™×” ×¢× ×¤×¨×•×¤×•×¤×•×œ", -40, "ğŸ’€ ×™×¤×™×œ ×œ\"×“."), ("×•× ×˜×•×œ×™×Ÿ", -10, "âŒ ×œ× ×™×¢×–×•×¨."), ("×”×’×‘×¨×ª ×—××¦×Ÿ", -10, "âŒ ×œ× ××¡×¤×™×§.")]),
            ("××™×“ ××—×¨×™ ×”××™× ×˜×•×‘×¦×™×”, ×œ\"×“ ×¦×•× ×— ×œ-50/30.",
             {"HR": 170, "BP": "50/30", "Sat": "98%"},
             [("×“×¨×™×¤ ××“×¨× ×œ×™×Ÿ/× ×•×¨××“×¨× ×œ×™×Ÿ", 10, "âœ… ×ª××™×›×” ××™× ×•×˜×¨×•×¤×™×ª."), ("×¢×•×“ ××™×“×–×•×œ×", -20, "âŒ ×™×—××™×¨ × ×¤×™×œ×”."), ("××§×¡×˜×•×‘×¦×™×”", -50, "ğŸ’€ ××¡×•×¨!"), ("×¨×§ × ×•×–×œ×™×", 0, "âš ï¸ ××•×œ×™ ×™×¢×–×•×¨.")]),
            ("×“×•× ×œ×‘! ××¡×™×¡×˜×•×œ×” ×‘××•× ×™×˜×•×¨.",
             {"HR": 0, "BP": "0/0", "Sat": "0%"},
             [("×¢×™×¡×•×™×™× + ××“×¨× ×œ×™×Ÿ", 10, "âœ… PALS."), ("×©×•×§ ×—×©××œ×™", -20, "âŒ ××¡×•×¨ ×‘××¡×™×¡×˜×•×œ×”."), ("××˜×¨×•×¤×™×Ÿ", -10, "âŒ ×œ× ×‘×¤×¨×•×˜×•×§×•×œ."), ("×‘×“×™×§×ª ×“×•×¤×§ ×“×§×”", -30, "ğŸ’€ ×‘×–×‘×•×– ×–××Ÿ.")]),
            ("×—×–×¨ ×“×•×¤×§ (ROSC). ×œ\"×“ 70/40. ××™×©×•× ×™× ×©×•×•×™×.",
             {"HR": 150, "BP": "70/40", "Sat": "95%"},
             [("×™×™×¦×•×‘: ×××™× ×™×, ×¡×“×¦×™×”", 10, "âœ… Post-arrest care."), ("××ª×Ÿ ×‘×™×§×¨×‘×•× ×˜", 0, "âš ï¸ ×¨×§ ×× ×™×© ×—××¦×ª."), ("×”×¤×¡×§×ª ×ª×¨×•×¤×•×ª", -20, "âŒ ××¡×•×›×Ÿ."), ("××§×¡×˜×•×‘×¦×™×”", -50, "ğŸ’€ ×œ×.")]),
            ("×—×•× 39. ×¤×¨×›×•×¡ ×›×œ×œ×™ ×§×¦×¨.",
             {"HR": 140, "BP": "85/50", "Sat": "96%"},
             [("×”×¢××¡×ª ×¤× ×™×˜×•××™×Ÿ/×§×¤×¨×”", 10, "âœ… ×× ×™×¢×ª ×¤×¨×›×•×¡×™×."), ("×¢×•×“ ××“×¨× ×œ×™×Ÿ", -20, "âŒ ×”×¤×¨×¢×•×ª ×§×¦×‘."), ("×”×ª×¢×œ××•×ª", -30, "âŒ × ×–×§ ××•×—×™."), ("××ª×Ÿ ×¡×•×›×¨", 0, "âš ï¸ ×¨×§ ×‘×”×™×¤×•×’×œ×™×§××™×”.")]),
            ("×‘×“×™×§×•×ª ×“×: ×”×™×¤×•×§×œ××™×” (2.8). ××’× ×–×™×•× × ××•×š.",
             {"HR": 130, "BP": "90/60", "Sat": "98%"},
             [("×ª×™×§×•×Ÿ ××’× ×–×™×•× ×•××– ××©×œ×’×Ÿ", 10, "âœ… × ×›×•×Ÿ."), ("×¨×§ ××©×œ×’×Ÿ", -10, "âŒ ×œ× ×™×¢×œ×” ×‘×œ×™ ××’× ×–×™×•×."), ("××©×œ×’×Ÿ ×‘×•×œ×•×¡ ××”×™×¨", -50, "ğŸ’€ ×“×•× ×œ×‘!"), ("×¤×•×¡×™×“", -10, "âŒ ×™×—××™×¨.")]),
            ("×©×ª×Ÿ ×›×”×” ×•××•×¢×˜. ×§×¨×™××˜×™× ×™×Ÿ ×¢×•×œ×” (AKI).",
             {"HR": 120, "BP": "95/65", "Sat": "99%"},
             [("×”×’×‘×œ×ª × ×•×–×œ×™× ×•×××–×Ÿ", 10, "âœ… ×× ×™×¢×ª ×’×•×“×©."), ("×”×¢××¡×ª × ×•×–×œ×™×", -20, "âŒ ×‘×¦×§×ª ×¨×™××•×ª."), ("×“×™××œ×™×–×” ××™×“", -10, "âš ï¸ ××•×§×“× ××“×™."), ("××ª×Ÿ ××©×œ×’×Ÿ", -30, "ğŸ’€ ××¡×•×›×Ÿ.")]),
            ("×¡×™×•×: ×”×™×œ×“ ×™×¦×™×‘, ××•× ×©×.",
             {"HR": 110, "BP": "100/70", "Sat": "100%"},
             [("×”××©×š ××¢×§×‘ ×•×˜×™×¤×•×œ", 10, "âœ… ×¡×™×™××ª ×‘×”×¦×œ×—×”."), ("-", 0, ""), ("-", 0, ""), ("-", 0, "")] )
        ]

if 'sim' not in st.session_state: st.session_state.sim = SimEngine()

# ==============================================================================
# 4. × ×™×•×•×˜ ×•×××©×§
# ==============================================================================

if 'user_info' not in st.session_state: st.session_state.user_info = {}
if 'completed' not in st.session_state: st.session_state.completed = set()
if 'page' not in st.session_state: st.session_state.page = "home"

def nav(p): st.session_state.page = p; st.rerun()

# Sidebar
with st.sidebar:
    st.image("https://img.icons8.com/color/96/nurse-male--v1.png", width=80)
    st.markdown("### ×¤×¨×•×¤×™×œ")
    if not st.session_state.user_info:
        name = st.text_input("×©× ××œ×")
        email = st.text_input("××™×™×œ")
        if st.button("×›× ×¡"):
            if email: st.session_state.user_info = {"n": name, "e": email}; st.rerun()
    else:
        st.success(f"××—×•×‘×¨: {st.session_state.user_info['n']}")
        
        # ×”×ª×§×“××•×ª
        total = sum(len(cat['topics']) for cat in FULL_DB.values())
        done = len(st.session_state.completed)
        if total > 0:
            st.markdown(f"**×”×ª×§×“××•×ª:** {int(done/total*100)}%")
            st.progress(done/total)
            
        if st.button("×™×¦×™××”"): st.session_state.user_info = {}; st.rerun()
    
    st.markdown("---")
    if st.session_state.user_info:
        st.button("ğŸ  ×‘×™×ª", on_click=lambda: nav("home"))
        st.button("ğŸ“š ×œ××™×“×”", on_click=lambda: nav("learn"))
        st.button("ğŸš‘ ×¡×™××•×œ×˜×•×¨", on_click=lambda: nav("sim"))
        st.button("ğŸ“ ××‘×—×Ÿ", on_click=lambda: nav("quiz"))
        if st.session_state.user_info.get('e') == 'yishaycopp@gmail.com':
            st.button("âš™ï¸ × ×™×”×•×œ", on_click=lambda: nav("admin"))

# Pages
if not st.session_state.user_info:
    st.header("×‘×¨×•×›×™× ×”×‘××™× ×œ××¢×¨×›×ª ×”×œ××™×“×” PICU")
    st.info("× × ×œ×”×ª×—×‘×¨ ×‘×ª×¤×¨×™×˜ ×”×¦×“.")
    st.stop()

if st.session_state.page == "home":
    st.markdown("<h1 style='text-align:center; color:#1565c0;'>××¨×›×– ×™×“×¢ ×•×¡×™××•×œ×¦×™×” - PICU</h1>", unsafe_allow_html=True)
    st.markdown("---")
    
    c1, c2, c3 = st.columns(3)
    with c1:
        st.markdown("<div class='nav-card'><div class='nav-icon'>ğŸ’Š</div><div class='nav-title'>×ª×¨×•×¤×•×ª</div></div>", unsafe_allow_html=True)
        if st.button("×¤×ª×— ×ª×¨×•×¤×•×ª"): st.session_state.cat_filter = "ğŸ’Š ×ª×¨×•×¤×•×ª ×•×¤×¨××§×•×œ×•×’×™×”"; nav("learn")
    with c2:
        st.markdown("<div class='nav-card'><div class='nav-icon'>ğŸš‘</div><div class='nav-title'>××¦×‘×™ ×—×™×¨×•×</div></div>", unsafe_allow_html=True)
        if st.button("×¤×ª×— ×—×™×¨×•×"): st.session_state.cat_filter = "ğŸš‘ ××¦×‘×™ ×—×™×¨×•× ×•×”×—×™×™××”"; nav("learn")
    with c3:
        st.markdown("<div class='nav-card'><div class='nav-icon'>ğŸ§ </div><div class='nav-title'>× ×•×™×¨×•×œ×•×’×™×”</div></div>", unsafe_allow_html=True)
        if st.button("×¤×ª×— × ×•×™×¨×•×œ×•×’×™×”"): st.session_state.cat_filter = "ğŸ§  × ×•×™×¨×•×œ×•×’×™×”"; nav("learn")
    
    c4, c5, c6 = st.columns(3)
    with c4:
        st.markdown("<div class='nav-card'><div class='nav-icon'>ğŸ©¸</div><div class='nav-title'>×”××˜×•×œ×•×’×™×”</div></div>", unsafe_allow_html=True)
        if st.button("×¤×ª×— ×”××˜×•×œ×•×’×™×”"): st.session_state.cat_filter = "ğŸ©¸ ×”××˜×•-××•× ×§×•×œ×•×’×™×”"; nav("learn")
    with c5:
        st.markdown("<div class='nav-card'><div class='nav-icon'>ğŸ</div><div class='nav-title'>×’×¡×˜×¨×•</div></div>", unsafe_allow_html=True)
        if st.button("×¤×ª×— ×’×¡×˜×¨×•"): st.session_state.cat_filter = "ğŸ ×’×¡×˜×¨×• ×•××˜×‘×•×œ×™"; nav("learn")
    with c6:
        st.markdown("<div class='nav-card'><div class='nav-icon'>ğŸ’‰</div><div class='nav-title'>×¦× ×ª×¨×™×</div></div>", unsafe_allow_html=True)
        if st.button("×¤×ª×— ×¦× ×ª×¨×™×"): st.session_state.cat_filter = "ğŸ’‰ ×¦× ×ª×¨×™× ×•×¤×¨×•×¦×“×•×¨×•×ª"; nav("learn")

elif st.session_state.page == "learn":
    st.title("×¡×¤×¨×™×™×” ××§×¦×•×¢×™×ª")
    cats = list(FULL_DB.keys())
    idx = 0
    if st.session_state.get('cat_filter') in cats: idx = cats.index(st.session_state.cat_filter)
    cat = st.selectbox("×ª×—×•×:", cats, index=idx)
    
    # ×ª×¨×•×¤×•×ª - ××™×•×Ÿ
    if "×ª×¨×•×¤×•×ª" in cat:
        drugs = sorted(FULL_DB[cat]['topics'].keys())
        choice = st.selectbox("×‘×—×¨ ×ª×¨×•×¤×” (×-×ª):", drugs)
        data = FULL_DB[cat]['topics'][choice]
    else:
        # ××—×¨×™× - ×›×¤×ª×•×¨×™×
        topics = list(FULL_DB[cat]['topics'].keys())
        st.markdown("#### × ×•×©××™×:")
        cols = st.columns(3)
        for i, t in enumerate(topics):
            icon = "âœ…" if t in st.session_state.completed else "â­•"
            if cols[i%3].button(f"{icon} {t}", use_container_width=True):
                st.session_state.curr_topic = t
        
        choice = st.session_state.get('curr_topic', topics[0])
        data = FULL_DB[cat]['topics'][choice]
        
    st.markdown("---")
    st.markdown("<div class='content-box'>", unsafe_allow_html=True)
    st.markdown(render_clean_html(data['text']), unsafe_allow_html=True)
    if data.get('image'): st.image(data['image'], width=400)
    st.markdown("</div>", unsafe_allow_html=True)
    
    if st.checkbox(f"×¡×™×™××ª×™ ×œ×œ××•×“: {choice}", key=choice):
        st.session_state.completed.add(choice)

elif st.session_state.page == "sim":
    st.title("×¡×™××•×œ×˜×•×¨")
    s = st.session_state.sim
    if st.button("ğŸ”„ ×”×ª×—×œ ××—×“×©"): s.reset(); st.rerun()
    
    if s.step < len(s.data):
        d = s.data[s.step]
        st.markdown(f"""
        <div class='sim-monitor'>
            <div>HR: <span class='sim-val'>{d[1]['HR']}</span></div>
            <div>BP: <span class='sim-val'>{d[1]['BP']}</span></div>
            <div>SAT: <span class='sim-val'>{d[1]['Sat']}</span></div>
        </div>
        """, unsafe_allow_html=True)
        st.info(f"**×©×œ×‘ {s.step+1}:** {d[0]}")
        
        cols = st.columns(2)
        opts = d[2]
        # ×©×™× ×œ×‘: ×œ×œ× ×¢×¨×‘×•×‘ ×›××Ÿ ×›×“×™ ×œ×©××•×¨ ×¢×œ ×¡×“×¨ ×”×§×•×“, ××‘×œ ××¤×©×¨ ×œ×”×•×¡×™×£ shuffle
        for i, opt in enumerate(opts):
            if cols[i%2].button(opt[0], key=f"o{s.step}{i}"):
                s.score += opt[1]
                s.log.append(f"×©×œ×‘ {s.step+1}: {opt[2]}")
                if opt[1] <= -30: s.dead = True
                s.step += 1
                st.rerun()
    else:
        if s.dead: st.error("ğŸ’€ ×”××˜×•×¤×œ ×§×¨×¡.")
        else: st.success(f"ğŸ‰ ×¡×™×™××ª! ×¦×™×•×Ÿ: {s.score}")
        for l in s.log: st.write(l)

elif st.session_state.page == "quiz":
    st.title("××‘×—×Ÿ ×™×“×¢")
    num = st.number_input("××¡×¤×¨ ×©××œ×•×ª:", 1, len(ALL_QUESTIONS), 5)
    if st.button("×¦×•×¨ ××‘×—×Ÿ"):
        st.session_state.q_curr = random.sample(ALL_QUESTIONS, num)
        st.session_state.q_res = None
        
    if 'q_curr' in st.session_state:
        score = 0
        with st.form("qf"):
            for i, q in enumerate(st.session_state.q_curr):
                st.write(f"**{i+1}. {q['q']}**")
                ops = q['opts'].copy()
                random.shuffle(ops)
                sel = st.radio(f"×ª×©×•×‘×” {i}", ops, key=f"q{i}", label_visibility="collapsed")
                if sel == q['a']: score += 1
                st.markdown("---")
            if st.form_submit_button("×”×’×©"):
                st.session_state.q_res = score
                
        if st.session_state.q_res is not None:
            st.metric("×¦×™×•×Ÿ", f"{int(st.session_state.q_res/len(st.session_state.q_curr)*100)}%")
            for i, q in enumerate(st.session_state.q_curr):
                with st.expander(f"×”×¡×‘×¨ ×œ×©××œ×” {i+1}"):
                    st.info(f"×ª×©×•×‘×”: {q['a']}")
                    st.write(q['exp'])

elif st.session_state.page == "admin":
    st.title("× ×™×”×•×œ")
    st.write("×××©×§ ×¢×¨×™×›×” ××œ× ×™×—×•×‘×¨ ×œ××¡×“ × ×ª×•× ×™× ×—×™×¦×•× ×™ ×‘×’×¨×¡×ª ×”×¤×¨×•×“×§×©×Ÿ.")
