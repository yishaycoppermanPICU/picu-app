import streamlit as st
import pandas as pd
import random
from datetime import datetime
import time
import json
import os

# --- ×§×•×‘×¥ × ×ª×•× ×™× ---
DB_FILE = "content_db.json"

# --- ×ª×•×›×Ÿ ××œ×: ××•×˜××¢ ××ª×•×š ×”×§×‘×¦×™× ×©×©×œ×—×ª ---
DEFAULT_CONTENT = {
    "×¤×¨×•×˜×•×§×•×œ×™ ×”×—×™×™××” ×•×©×•×§": {
        "×©×•×§ ×”×™×¤×•×•×œ××™ (Hypovolemic)": {
            "text": """## ×©×•×§ ×”×™×¤×•×•×œ××™ / ×”××•×¨×’×™
**×”×’×“×¨×”:** ××¦×‘ ×”×××•×¤×™×™×Ÿ ×‘×¤×¨×¤×•×–×™×” ×œ×§×•×™×” ×œ×¨×§××•×ª ×¢×§×‘ ××•×‘×“×Ÿ × ×¤×—.

### ×¡×™×× ×™× ×§×œ×™× ×™×™× ×œ×¤×™ ×©×œ×‘×™×:
* **×©×œ×‘ 1 (×¤×™×¦×•×™):** ×œ"×“ ×ª×§×™×Ÿ, ×“×•×¤×§ ×•× ×©×™××” ×¡×“×™×¨×™×, ××™×œ×•×™ ×§×¤×™×œ×¨×™ ×ª×§×™×Ÿ.
* **×©×œ×‘ 2:** ×œ"×“ ×ª×§×™×Ÿ/× ××•×š, ××™×œ×•×™ ×§×¤×™×œ×¨×™ ××™×˜×™, ×–×™×¢×” ×§×¨×”, ×˜×›×™×§×¨×“×™×”, ×˜×›×™×¤× ×™××”, ×™×¨×™×“×” ×‘×©×ª×Ÿ.
* **×©×œ×‘ 3 (Decompensated):** ×œ"×“ ×¡×™×¡×˜×•×œ×™ ×¦×•× ×— (×¡×™××Ÿ ×××•×—×¨!), ××™×œ×•×™ ×§×¤×™×œ×¨×™ ××™×˜×™ ×××•×“, ×©×™× ×•×™ ×‘×”×›×¨×”.
* [cite_start]**×©×œ×‘ 4:** ×œ"×“ × ××•×š ×××•×“, ×¢×•×¨ ×—×™×•×•×¨/×©×™×©, ×—×•×¡×¨ ×”×›×¨×”, ×× ×•×¨×™×” [cite: 886-889].

### ×˜×™×¤×•×œ ×‘×—×™×¨×•×:
1. **×’×™×©×” ×•×¨×™×“×™×ª:** ×¨×¦×•×™ ×©× ×™ ×•× ×¤×œ×•× ×™× ×¢×‘×™× ××• IO.
2. [cite_start]**× ×•×–×œ×™×:** ×‘×•×œ×•×¡ ×§×¨×™×¡×˜×œ×•××™×“×™× (×¡×œ×™×™×Ÿ/×”×¨×˜××Ÿ) **20 ×"×œ/×§"×’** ×‘×”×–×¨×§×” ××”×™×¨×” (×ª×•×š 5-10 ×“×§')[cite: 906].
3. [cite_start]**×”×¢×¨×›×” ×—×•×–×¨×ª:** × ×™×ª×Ÿ ×œ×—×–×•×¨ ×¢×œ ×”×‘×•×œ×•×¡ ×¢×“ 3 ×¤×¢××™× (×¡×”"×› 60 ×"×œ/×§"×’)[cite: 907].
4. [cite_start]**×©×•×§ ×”××•×¨×’×™:** ×× ××™×Ÿ ×©×™×¤×•×¨ ×œ××—×¨ × ×•×–×œ×™× -> ××ª×Ÿ ×“× (PC) ×œ×¤×™ 10 ×"×œ/×§"×’[cite: 920].""",
            "image": "",
            "video": ""
        },
        "×¡×¤×¡×™×¡ (Sepsis)": {
            "text": """## ×¡×¤×¡×™×¡ ×•×©×•×§ ×¡×¤×˜×™
[cite_start]**×”×’×“×¨×”:** ×–×™×”×•× (×—×©×•×“ ××• ×××•××ª) + SIRS (×—×•×, ×˜×›×™×§×¨×“×™×”, ×˜×›×™×¤× ×™××”, ×œ×•×™×§×•×¦×™×˜×•×–×™×¡)[cite: 826].

### ×”×˜×™×¤×•×œ ×‘×©×¢×” ×”×¨××©×•× ×” (Golden Hour):
1. [cite_start]**×ª×¨×‘×™×•×ª ×“×:** ×œ×§×—×ª ×œ×¤× ×™ ×× ×˜×™×‘×™×•×˜×™×§×” (××œ× ×× ××¢×›×‘ ××ª×Ÿ)[cite: 842].
2. [cite_start]**×× ×˜×™×‘×™×•×˜×™×§×”:** ×¨×—×‘×ª ×˜×•×•×— (×œ××©×œ ××¨×•×¤× × 20 ×"×’/×§"×’) ×ª×•×š ×©×¢×”![cite: 843].
3. [cite_start]**× ×•×–×œ×™×:** ×‘×•×œ×•×¡ 20 ×"×œ/×§"×’ (×¢×“ 60 ×"×œ/×§"×’) ×ª×•×š × ×™×˜×•×¨ ×¢×•××¡ × ×•×–×œ×™× (×›×‘×“, ×”××–× ×” ×œ×¨×™××•×ª)[cite: 845].
4. [cite_start]**×‘×“×™×§×ª ×œ×§×˜×˜:** ××“×“ ×œ×¤×¨×¤×•×–×™×”[cite: 844].

### ×©×•×§ ×¢××™×“ (Refractory):
* [cite_start]×× ××™×Ÿ ×ª×’×•×‘×” ×œ× ×•×–×œ×™× (60 ×"×œ/×§"×’) -> ×”×ª×—×œ×ª ×××™× ×™× (× ×•×¨××“×¨× ×œ×™×Ÿ/××“×¨× ×œ×™×Ÿ)[cite: 848].
* [cite_start]×©×•×§ ×¡×¤×˜×™ ×¢××™×“ ×œ×§×˜×›×•×œ××™× ×™× -> ×œ×©×§×•×œ ×”×™×“×¨×•×§×•×¨×˜×™×–×•×Ÿ[cite: 850].""",
            "image": "",
            "video": ""
        },
        "×× ×¤×™×œ×§×¡×™×¡": {
            "text": """## ×× ×¤×™×œ×§×¡×™×¡ (Anaphylaxis)
×ª×’×•×‘×” ××œ×¨×’×™×ª ××¡×›× ×ª ×—×™×™×. [cite_start]×¡×™×× ×™×: ××•×¨×˜×™×§×¨×™×”, ×× ×’×™×•××“××”, ×¡×˜×¨×™×“×•×¨, ×¦×¤×¦×•×¤×™×, ×”×™×¤×•×˜× ×¡×™×‘×™×•×ª [cite: 930-931].

### ×˜×™×¤×•×œ ××™×™×“×™ (×§×• ×¨××©×•×Ÿ):
1. **××“×¨× ×œ×™×Ÿ IM:** ×”×˜×™×¤×•×œ ×”×—×©×•×‘ ×‘×™×•×ª×¨!
   * **××™× ×•×Ÿ:** 0.01 ×"×’/×§"×’ (××§×¡' 0.5 ×"×’).
   * **××™×§×•×:** ×™×¨×š (Vastus Lateralis).
   * [cite_start]**×—×–×¨×”:** ×›×œ 5-15 ×“×§×•×ª ×× ××™×Ÿ ×©×™×¤×•×¨ [cite: 936-937].

### ×˜×™×¤×•×œ × ×•×¡×£:
* [cite_start]**× ×•×–×œ×™×:** 20 ×"×œ/×§"×’ ×‘×•×œ×•×¡[cite: 941].
* [cite_start]**×•× ×˜×•×œ×™×Ÿ:** ×œ×‘×¨×•× ×›×•×¡×¤××–×[cite: 942].
* [cite_start]**×¡×˜×¨×•××™×“×™× ×•×× ×˜×™×”×™×¡×˜××™× ×™×:** ×˜×™×¤×•×œ ×§×• ×©× ×™ ×‘×œ×‘×“ [cite: 944-946].""",
            "image": "",
            "video": ""
        },
         "×”×—×™×™××” (ALS)": {
            "text": """## ×“×’×©×™× ×‘×”×—×™×™××ª ×™×œ×“×™× (PALS)
### ×ª×¨×•×¤×•×ª ×¢×™×§×¨×™×•×ª:
* **××“×¨× ×œ×™×Ÿ (IV/IO):** 0.01 ×"×’/×§"×’ (0.1 ×"×œ/×§"×’ ××“×™×œ×•×œ 1:10,000). [cite_start]××§×¡' 1 ×"×’. ×›×œ 3-5 ×“×§' [cite: 38-40].
* [cite_start]**×××™××•×“×•×¨×•×Ÿ (VF/pVT):** 5 ×"×’/×§"×’ (××§×¡' 300 ×"×’). × ×™×ª×Ÿ ×œ×—×–×•×¨ ×¢×“ 15 ×"×’/×§"×’[cite: 299, 1005].
* [cite_start]**×œ×™×“×•×§××™×Ÿ:** 1 ×"×’/×§"×’[cite: 80].

### ×“×¤×™×‘×¨×™×œ×¦×™×”:
* **×©×•×§ ×¨××©×•×Ÿ:** 2 J/kg.
* **×©×•×§ ×©× ×™:** 4 J/kg.
* [cite_start]**×©×•×§×™× ×”×‘××™×:** 4-10 J/kg [cite: 1034-1038].

### ×”×¤×™×›×™× (H's & T's):
[cite_start]×”×™×¤×•×•×œ××™×”, ×”×™×¤×•×§×¡×™×”, ×—××¦×ª, ×”×™×¤×•/×”×™×¤×¨×§×œ××™×”, ×”×™×¤×•×’×œ×™×§××™×”, ×”×™×¤×•×ª×¨××™×”, ×˜×•×§×¡×™× ×™×, ×˜××¤×•× ×“×”, ×˜× ×©×Ÿ, ×˜×¨×•××‘×•×–×™×¡ [cite: 1010-1021].""",
            "image": "",
            "video": ""
        }
    },
    "×ª×¨×•×¤×•×ª (××™× ×•× ×™× ×•×“×’×©×™×)": {
        "××“× ×•×–×™×Ÿ (SVT)": {
            "text": """## ××“× ×•×–×™×Ÿ (Adenosine)
**××™× ×“×™×§×¦×™×”:** SVT (Supraventricular Tachycardia).

### ××•×¤×Ÿ ××ª×Ÿ (×§×¨×™×˜×™!):
×–××Ÿ ××—×¦×™×ª ×—×™×™× ×©×œ ×©× ×™×•×ª. [cite_start]×—×•×‘×” ×œ×ª×ª ×‘×©×™×˜×ª **Push-Flush**: ×”×–×¨×§×” ××”×™×¨×” ×‘×‘×¨×– ×”×›×™ ×§×¨×•×‘ ×œ×œ×‘, ×•××™×“ ×©×˜×™×¤×” ×‘-5-10 ×"×œ ×¡×œ×™×™×Ÿ[cite: 72, 988].

### ××™× ×•× ×™×:
1. [cite_start]**×× ×” ×¨××©×•× ×”:** 0.1 ×"×’/×§"×’ (××§×¡' 6 ×"×’)[cite: 60].
2. [cite_start]**×× ×” ×©× ×™×”:** 0.2 ×"×’/×§"×’ (××§×¡' 12 ×"×’)[cite: 62].""",
            "image": "",
            "video": ""
        },
        "×¡×“×¦×™×” ×•××™× ×˜×•×‘×¦×™×”": {
            "text": """## ×ª×¨×•×¤×•×ª ×œ×”×¨×“××” ×•×¡×“×¦×™×”
* **××™×“×–×•×œ× (Dormicum):** 0.05-0.1 ×"×’/×§"×’. [cite_start]×–×”×™×¨×•×ª ×‘×ª×™× ×•×§×•×ª < ×—×¦×™ ×©× ×” (×“×™×›×•×™ × ×©×™××ª×™)[cite: 96, 100].
* **×§×˜××™×Ÿ (Ketamine):** 1-2 ×"×’/×§"×’. [cite_start]×©×•××¨ ×¢×œ ×¨×¤×œ×§×¡ × ×©×™××” ×•×œ"×“ (×˜×•×‘ ×œ×©×•×§). ×ª"×œ: ×¨×™×•×¨, ×œ×¨×™× ×’×•×¡×¤××–× [cite: 124, 362-364].
* **×¨×•×§×•×¨×•× ×™×•× (Rocuronium):** ××©×ª×§ ×©×¨×™×¨×™×. 1 ×"×’/×§"×’ (RSI). [cite_start]×—×•×‘×” ×œ×ª×ª ×¡×“×¦×™×” ×œ×¤× ×™![cite: 155, 161].
* **××˜×•××™×“×™×™×˜:** 0.2-0.3 ×"×’/×§"×’. [cite_start]×–×”×™×¨×•×ª: ×“×™×›×•×™ ××“×¨× ×œ (×œ× ×œ×ª×ª ×‘×¡×¤×¡×™×¡!)[cite: 400, 901].""",
            "image": "",
            "video": ""
        },
        "××œ×§×˜×¨×•×œ×™×˜×™×": {
            "text": """## ×ª×™×§×•×Ÿ ××©×œ×’×Ÿ ×•××’× ×–×™×•×
### ××©×œ×’×Ÿ (Potassium)
* **×¢×¨×›×™× ×ª×§×™× ×™×:** 3.5-5.0.
* [cite_start]**×—×•×§ ×—×©×•×‘:** ×× ×™×© ×”×™×¤×•×§×œ××™×” ×•×”×™×¤×•××’× ×–××™×” -> **×œ×ª×§×Ÿ ××’× ×–×™×•× ×§×•×“×!**[cite: 10].
* [cite_start]**×§×¦×‘ ××ª×Ÿ IV:** ××§×¡' 1 mEq/kg/h (××• 40 mEq/h) ×‘×•×¨×™×“ ××¨×›×–×™[cite: 31].

### ×”×™×¤×¨×§×œ××™×” (×˜×™×¤×•×œ ×—×™×¨×•×):
1. [cite_start]**×§×œ×¦×™×•× ×’×œ×•×§×•× ×˜:** ×”×’× ×” ×¢×œ ×”×œ×‘[cite: 74, 529].
2. [cite_start]**××™× ×¡×•×œ×™×Ÿ + ×’×œ×•×§×•×–:** ×œ×”×›× ×¡×ª ××©×œ×’×Ÿ ×œ×ª××™× (0.1 ×™×—'/×§"×’)[cite: 528].
3. [cite_start]**×•× ×˜×•×œ×™×Ÿ:** ××™× ×”×œ×¦×™×”[cite: 252].""",
            "image": "",
            "video": ""
        }
    },
    "×˜×¨××•××” ×•× ×•×™×¨×•×œ×•×’×™×”": {
        "×—×‘×œ×ª ×¨××© (TBI)": {
            "text": """## ×—×‘×œ×ª ×¨××© (TBI)
**×™×¢×“×™×:** ×©××™×¨×” ×¢×œ CPP (×œ×—×¥ ×–×™×œ×•×— ××•×—×™). [cite_start]CPP = MAP - ICP[cite: 1132].

### ×˜×¨×™××“×” ×¢"×© ×§×•×©×™× ×’ (×¢×œ×™×™×ª ICP):
1. ×™×ª×¨ ×œ×—×¥ ×“×.
2. ×‘×¨×“×™×§×¨×“×™×”.
3. [cite_start]× ×©×™××” ×œ× ×¡×“×™×¨×”[cite: 1142].

### ×˜×™×¤×•×œ ×‘-ICP ××•×’×‘×¨:
* [cite_start]×”×¨××ª ×¨××© 30 ××¢×œ×•×ª[cite: 1137].
* [cite_start]**×¡×œ×™×™×Ÿ ×”×™×¤×¨×˜×•× ×™ 3%:** 3-5 ×"×œ/×§"×’[cite: 1153].
* [cite_start]**×× ×™×˜×•×œ:** 0.5-1 ×’×¨×/×§"×’ (×× ××•×¡××•×œ×¨×™×•×ª < 320)[cite: 1156].
* [cite_start]×”×™×¤×¨×•×•× ×˜×™×œ×¦×™×” ××ª×•× ×” (PCO2 30-35) ×¨×§ ×‘××¦×‘ ×”×¨× ×™××¦×™×”[cite: 1145].""",
            "image": "",
            "video": ""
        },
        "×¡×˜×˜×•×¡ ××¤×™×œ×¤×˜×™×§×•×¡": {
            "text": """## ×¤×¨×›×•×¡×™× (Seizures)
### ×˜×™×¤×•×œ ×§×• ×¨××©×•×Ÿ (×‘× ×–×•×“×™××–×¤×™× ×™×):
* **××™×“×–×•×œ× (IV):** 0.1-0.2 ×"×’/×§"×’.
* [cite_start]**××™×“×–×•×œ× (× ××–×œ×™/×‘×•×§××œ×™):** 0.2 ×"×’/×§"×’[cite: 102].
* [cite_start]**×“×™××–×¤× (×•××œ×™×•×):** 0.1-0.2 ×"×’/×§"×’ (IV)[cite: 384].

### ×˜×™×¤×•×œ ×§×• ×©× ×™ (×”×¢××¡×”):
* [cite_start]**×¤× ×™×˜×•××™×Ÿ (Epanutin):** 20 ×"×’/×§"×’ (×‘×¡×œ×™×™×Ÿ ×‘×œ×‘×“, ×œ××˜!)[cite: 313].
* [cite_start]**×œ×‘×˜×™×¨×¦×˜× (Keppra):** 20-60 ×"×’/×§"×’[cite: 329].""",
            "image": "",
            "video": ""
        }
    }
}

# --- ×××’×¨ ×©××œ×•×ª ××§×™×£ (20 ×©××œ×•×ª ××‘×•×¡×¡×•×ª ××§×•×¨×•×ª) ---
ALL_QUESTIONS = [
    {
        "topic": "×ª×¨×•×¤×•×ª",
        "question": "××”×• ×”××™× ×•×Ÿ ×”××§×•×‘×œ ×œ××“×¨× ×œ×™×Ÿ IV ×‘××”×œ×š ×”×—×™×™××ª ×™×œ×“×™× (PALS)?",
        "options": ["0.01 ×\"×’/×§\"×’ (1:10,000)", "0.1 ×\"×’/×§\"×’ (1:1,000)", "1 ×\"×’ ×œ×§\"×’", "0.5 ×\"×’ ×œ×§\"×’"],
        "correct": "0.01 ×\"×’/×§\"×’ (1:10,000)",
        "explanation": "×”××™× ×•×Ÿ ×‘×”×—×™×™××” ×”×•× 0.01 ×\"×’ ×œ×§\"×’. [cite_start]××™× ×•×Ÿ ×©×œ 0.1 ××™×•×¢×“ ×œ×¢×™×ª×™× ×œ××™× ×”×œ×¦×™×” ××• ×“×¨×›×™× ××—×¨×•×ª, ××š ×‘-IV ×”×•× ×¤×™ 10 ×•×¢×œ×•×œ ×œ×”×™×•×ª ×§×˜×œ× ×™ [cite: 38-40]."
    },
    {
        "topic": "×ª×¨×•×¤×•×ª",
        "question": "×›×™×¦×“ ×™×© ×œ×ª×ª ××“× ×•×–×™×Ÿ ×œ×˜×™×¤×•×œ ×‘-SVT?",
        "options": ["×“×¨×™×¤ ××™×˜×™", "×¤×•×© ××”×™×¨ ×‘×•×¨×™×“ ××¨×›×–×™/×§×¨×•×‘ ×œ×œ×‘ + ×©×˜×™×¤×”", "××ª×Ÿ ×¤×•××™", "IM ×‘×™×¨×š"],
        "correct": "×¤×•×© ××”×™×¨ ×‘×•×¨×™×“ ××¨×›×–×™/×§×¨×•×‘ ×œ×œ×‘ + ×©×˜×™×¤×”",
        "explanation": "×–××Ÿ ××—×¦×™×ª ×”×—×™×™× ×§×¦×¨ ×××•×“ (×©× ×™×•×ª). [cite_start]×—×•×‘×” ×œ×ª×ª ×‘×©×™×˜×ª Push-Flush ×›×“×™ ×©×™×’×™×¢ ×œ×œ×‘ ×œ×¤× ×™ ×©×™×ª×¤×¨×§[cite: 72]."
    },
    {
        "topic": "×©×•×§",
        "question": "×™×œ×“ ×‘×©×•×§ ×”×™×¤×•×•×œ××™. ××”×• ××™× ×•×Ÿ ×‘×•×œ×•×¡ ×”× ×•×–×œ×™× ×”×¨××©×•× ×™?",
        "options": ["20 ×\"×œ/×§\"×’", "50 ×\"×œ/×§\"×’", "5 ×\"×œ/×§\"×’", "10 ×\"×œ/×§\"×’"],
        "correct": "20 ×\"×œ/×§\"×’",
        [cite_start]"explanation": "×”×˜×™×¤×•×œ ×‘×©×•×§ ×”×™×¤×•×•×œ××™/×¡×¤×˜×™ ××ª×—×™×œ ×‘×‘×•×œ×•×¡ ×©×œ 20 ×\"×œ/×§\"×’ ×§×¨×™×¡×˜×œ×•××™×“×™× ×ª×•×š 5-10 ×“×§×•×ª[cite: 906]."
    },
    {
        "topic": "× ×•×™×¨×•×œ×•×’×™×”",
        "question": "××”×™ ×”×˜×¨×™××“×” ×¢\"×© ×§×•×©×™× ×’ ×”××¢×™×“×” ×¢×œ ×¢×œ×™×™×ª ×œ×—×¥ ×ª×•×š ×’×•×œ×’×•×œ×ª×™ (ICP)?",
        "options": ["×˜×›×™×§×¨×“×™×”, ×™×¨×™×“×ª ×œ\"×“, ×—×•×", "×‘×¨×“×™×§×¨×“×™×”, ×™×ª×¨ ×œ\"×“, × ×©×™××” ×œ× ×¡×“×™×¨×”", "××™×©×•× ×™× ×¦×¨×™×, ×”×–×¢×”, ×©×œ×©×•×œ", "×›××‘ ×¨××©, ×˜×©×˜×•×© ×¨××™×”, ×”×§××•×ª"],
        "correct": "×‘×¨×“×™×§×¨×“×™×”, ×™×ª×¨ ×œ\"×“, × ×©×™××” ×œ× ×¡×“×™×¨×”",
        [cite_start]"explanation": "×–×”×• ×¡×™××Ÿ ×××•×—×¨ ×œ×œ×—×¥ ×¢×œ ×’×–×¢ ×”××•×— ×•×¡×›× ×ª ×”×¨× ×™××¦×™×”[cite: 1142]."
    },
    {
        "topic": "×ª×¨×•×¤×•×ª",
        "question": "×‘×™×œ×“ ×¢× ×”×™×¤×•×§×œ××™×” ×•×”×™×¤×•××’× ×–××™×”, ××”×• ×¡×“×¨ ×”×˜×™×¤×•×œ ×”× ×›×•×Ÿ?",
        "options": ["×œ×ª×§×Ÿ ××’× ×–×™×•× ×§×•×“×", "×œ×ª×§×Ÿ ××©×œ×’×Ÿ ×§×•×“×", "××™×Ÿ ×—×©×™×‘×•×ª ×œ×¡×“×¨", "×œ×ª×ª ×¨×§ ××©×œ×’×Ÿ"],
        "correct": "×œ×ª×§×Ÿ ××’× ×–×™×•× ×§×•×“×",
        [cite_start]"explanation": "×œ×œ× ×ª×™×§×•×Ÿ ××’× ×–×™×•×, ×”×›×œ×™×” ×ª××©×™×š ×œ×”×¤×¨×™×© ××©×œ×’×Ÿ ×•×”×”×™×¤×•×§×œ××™×” ×ª×”×™×” ×¢××™×“×” ×œ×˜×™×¤×•×œ[cite: 10]."
    },
    {
        "topic": "×”×—×™×™××”",
        "question": "××”×• ×”××™× ×•×Ÿ ×”×¨××©×•× ×™ ×œ×©×•×§ ×—×©××œ×™ (Defibrillation) ×‘×¤×¨×¤×•×¨ ×—×“×¨×™× (VF)?",
        "options": ["2 J/kg", "4 J/kg", "10 J/kg", "0.5 J/kg"],
        "correct": "2 J/kg",
        "explanation": "×”×× ×” ×”×¨××©×•× ×” ×”×™× 2 J/kg. [cite_start]×× ×” ×©× ×™×” 4 J/kg[cite: 1034]."
    },
    {
        "topic": "×¡×¤×¡×™×¡",
        "question": "×ª×•×š ×›××” ×–××Ÿ ×™×© ×œ×ª×ª ×× ×˜×™×‘×™×•×˜×™×§×” ×œ×™×œ×“ ×¢× ×—×©×“ ×œ×©×•×§ ×¡×¤×˜×™?",
        "options": ["×ª×•×š ×©×¢×” (Golden Hour)", "×ª×•×š 3 ×©×¢×•×ª", "×œ××—×¨ ×§×‘×œ×ª ×ª×©×•×‘×•×ª ×ª×¨×‘×™×ª", "×ª×•×š 6 ×©×¢×•×ª"],
        "correct": "×ª×•×š ×©×¢×” (Golden Hour)",
        [cite_start]"explanation": "×¢×™×›×•×‘ ×‘××ª×Ÿ ×× ×˜×™×‘×™×•×˜×™×§×” ××¢×œ×” ××©××¢×•×ª×™×ª ××ª ×”×ª××•×ª×”[cite: 840, 843]."
    },
    {
        "topic": "×ª×¨×•×¤×•×ª",
        "question": "××™×–×• ×ª×¨×•×¤×” × ×™×ª× ×ª ×›××™× ×”×œ×¦×™×” ×œ×˜×™×¤×•×œ ×‘×¡×˜×¨×™×“×•×¨?",
        "options": ["××“×¨× ×œ×™×Ÿ", "×•× ×˜×•×œ×™×Ÿ", "×¡×œ×™×™×Ÿ ×”×™×¤×¨×˜×•× ×™", "×‘×•×“×™×§×•×¨×˜"],
        "correct": "××“×¨× ×œ×™×Ÿ",
        "explanation": "××“×¨× ×œ×™×Ÿ (Racemic ××• L-Epinephrine) ××›×•×•×¥ ×›×œ×™ ×“× ×‘×“×¨×›×™ ×”××•×•×™×¨ ×•××¤×—×™×ª ×‘×¦×§×ª. [cite_start]××™× ×•×Ÿ 0.5 ×\"×œ/×§\"×’[cite: 48]."
    },
    {
        "topic": "×× ×¤×™×œ×§×¡×™×¡",
        "question": "××”×• ×”×˜×™×¤×•×œ ×”×ª×¨×•×¤×ª×™ ×”×¨××©×•×Ÿ ×•×”××¦×™×œ ×—×™×™× ×‘×× ×¤×™×œ×§×¡×™×¡?",
        "options": ["××“×¨× ×œ×™×Ÿ IM", "×¡×˜×¨×•××™×“×™× IV", "×× ×˜×™-×”×™×¡×˜××™× ×™×", "×•× ×˜×•×œ×™×Ÿ"],
        "correct": "××“×¨× ×œ×™×Ÿ IM",
        [cite_start]"explanation": "××“×¨× ×œ×™×Ÿ IM ×”×•× ×”×˜×™×¤×•×œ ×”×™×—×™×“ ×”××•×›×— ×”××•× ×¢ ×§×¨×™×¡×” ×”××•×“×™× ××™×ª ×•× ×©×™××ª×™×ª ×‘×©×œ×‘ ×”××™×™×“×™[cite: 933]."
    },
    {
        "topic": "×ª×¨×•×¤×•×ª",
        "question": "××™×–×• ×ª×¨×•×¤×” ××©××©×ª ×œ×”×’× ×” ×¢×œ ×©×¨×™×¨ ×”×œ×‘ (Cardioprotection) ×‘×¢×ª ×”×™×¤×¨×§×œ××™×” ×§×©×”?",
        "options": ["×§×œ×¦×™×•× ×’×œ×•×§×•× ×˜", "××™× ×¡×•×œ×™×Ÿ", "×¤×•×¡×™×“", "×•× ×˜×•×œ×™×Ÿ"],
        "correct": "×§×œ×¦×™×•× ×’×œ×•×§×•× ×˜",
        [cite_start]"explanation": "×§×œ×¦×™×•× ××™×™×¦×‘ ××ª ×”×××‘×¨× ×” ×©×œ ×ª××™ ×”×œ×‘ ×•××•× ×¢ ×”×¤×¨×¢×•×ª ×§×¦×‘, ××š ××™× ×• ××•×¨×™×“ ××ª ×¨××ª ×”××©×œ×’×Ÿ ×‘×“×[cite: 74, 529]."
    },
    {
        "topic": "×©×•×§",
        "question": "××™×–×” ×¡×™××Ÿ × ×—×©×‘ ×œ×¡×™××Ÿ ×××•×—×¨ (Late Sign) ×•××‘×©×¨ ×¨×¢×•×ª ×‘×©×•×§ ×‘×™×œ×“×™×?",
        "options": ["×™×¨×™×“×ª ×œ×—×¥ ×“× (Hypotension)", "×˜×›×™×§×¨×“×™×”", "××™×œ×•×™ ×§×¤×™×œ×¨×™ ××™×˜×™", "××•×œ×™×’×•×¨×™×”"],
        "correct": "×™×¨×™×“×ª ×œ×—×¥ ×“× (Hypotension)",
        [cite_start]"explanation": "×™×œ×“×™× ××¤×¦×™× ×”×™×˜×‘ ×¢\"×™ ×˜×›×™×§×¨×“×™×” ×•×›×™×•×•×¥ ×›×œ×™ ×“×. ×™×¨×™×“×ª ×œ\"×“ ××¢×™×“×” ×¢×œ ×§×¨×™×¡×” ×©×œ ×× ×’× ×•× ×™ ×”×¤×™×¦×•×™ (Decompensated Shock)[cite: 882]."
    },
    {
        "topic": "×¡×“×¦×™×”",
        "question": "××™×–×• ×ª×¨×•×¤×ª ×¡×“×¦×™×” ××•××œ×¦×ª ×œ××™× ×˜×•×‘×¦×™×” ×‘×—×•×œ×” ×œ× ×™×¦×™×‘ ×”××•×“×™× ××™×ª (×©×•×§)?",
        "options": ["×§×˜××™×Ÿ", "×¤×¨×•×¤×•×¤×•×œ", "××™×“×–×•×œ×", "×¤× ×˜×•×˜×œ"],
        "correct": "×§×˜××™×Ÿ",
        [cite_start]"explanation": "×§×˜××™×Ÿ ×©×•××¨ ×¢×œ ×”×˜×•× ×•×¡ ×”×¡×™××¤×˜×ª×™ ×•××™× ×• ××•×¨×™×“ ×œ×—×¥ ×“× (×œ×¢×•××ª ×¤×¨×•×¤×•×¤×•×œ/××™×“×–×•×œ×), ×•×œ×›×Ÿ ××ª××™× ×œ×©×•×§[cite: 364, 899]."
    },
    {
        "topic": "×˜×¨××•××”",
        "question": "××”×• ×”×˜×™×¤×•×œ ×”××™×™×“×™ ×‘×™×œ×“ ×¢× TBI ×•×¡×™×× ×™ ×”×¨× ×™××¦×™×” (×§×•×©×™× ×’)?",
        "options": ["×¡×œ×™×™×Ÿ ×”×™×¤×¨×˜×•× ×™ 3%", "×”×•×¨×“×ª ×¨××© ×œ××˜×”", "××ª×Ÿ × ×•×–×œ×™× ×”×™×¤×•×˜×•× ×™×™×", "×—×™××•× ×”×—×•×œ×”"],
        "correct": "×¡×œ×™×™×Ÿ ×”×™×¤×¨×˜×•× ×™ 3%",
        [cite_start]"explanation": "×¡×œ×™×™×Ÿ ×”×™×¤×¨×˜×•× ×™ (××• ×× ×™×˜×•×œ) ××•×¨×™×“ ICP ×‘×¦×•×¨×” ×—×¨×™×¤×” ×¢\"×™ ××©×™×›×ª × ×•×–×œ×™× ××”××•×—[cite: 1153]."
    },
    {
        "topic": "×ª×¨×•×¤×•×ª",
        "question": "××” ×”××™× ×•×Ÿ ×©×œ ×‘×•×œ×•×¡ ×××™××•×“×•×¨×•×Ÿ (×¤×¨×•×§×•×¨) ×‘×”×—×™×™××ª VF/pVT?",
        "options": ["5 ×\"×’/×§\"×’", "1 ×\"×’/×§\"×’", "10 ×\"×’/×§\"×’", "20 ×\"×’/×§\"×’"],
        "correct": "5 ×\"×’/×§\"×’",
        "explanation": "×”××™× ×•×Ÿ ×”×•× 5 ×\"×’/×§\"×’ IV/IO. [cite_start]× ×™×ª×Ÿ ×œ×—×–×•×¨ ×¢×“ ××§×¡×™××•× ×›×•×œ×œ ×©×œ 15 ×\"×’/×§\"×’[cite: 299]."
    },
    {
        "topic": "×©×•×§",
        "question": "××”×• ×”××“×“ ×”××¢×‘×“×ª×™ ×”×˜×•×‘ ×‘×™×•×ª×¨ ×œ×”×¢×¨×›×ª ×¤×¨×¤×•×–×™×” ×¨×§××ª×™×ª ×‘×©×•×§?",
        "options": ["×œ×§×˜×˜ (Lactate)", "×¡×¤×™×¨×ª ×“×", "×’×œ×•×§×•×–", "× ×ª×¨×Ÿ"],
        "correct": "×œ×§×˜×˜ (Lactate)",
        [cite_start]"explanation": "×¢×œ×™×™×ª ×œ×§×˜×˜ ××¢×™×“×” ×¢×œ ××˜×‘×•×œ×™×–× ×× ××™×¨×•×‘×™ ×¢×§×‘ ×—×•×¡×¨ ×—××¦×Ÿ ×‘×¨×§××•×ª[cite: 844, 890]."
    },
    {
        "topic": "×ª×¨×•×¤×•×ª",
        "question": "××“×•×¢ ××¡×•×¨ ×œ×ª×ª ××˜×•××™×“×™×™×˜ (Etomidate) ×œ×—×•×œ×” ×¢× ×—×©×“ ×œ×©×•×§ ×¡×¤×˜×™?",
        "options": ["×’×•×¨× ×œ×“×™×›×•×™ ××“×¨× ×œ", "×’×•×¨× ×œ×˜×›×™×§×¨×“×™×” ×§×©×”", "×’×•×¨× ×œ×“×™×›×•×™ × ×©×™××ª×™", "×’×•×¨× ×œ××œ×¨×’×™×”"],
        "correct": "×’×•×¨× ×œ×“×™×›×•×™ ××“×¨× ×œ",
        [cite_start]"explanation": "××˜×•××™×“×™×™×˜ ××“×›× ××ª ×™×™×¦×•×¨ ×”×§×•×¨×˜×™×–×•×œ ×‘××“×¨× ×œ, ××” ×©×¢×œ×•×œ ×œ×”×—××™×¨ ××ª ×”×©×•×§ ×”×¡×¤×˜×™[cite: 402, 901]."
    },
    {
        "topic": "×ª×¨×•×¤×•×ª",
        "question": "××”×™ ×“×¨×š ×”××ª×Ÿ ×”××•×¢×“×¤×ª ×œ××©×œ×’×Ÿ (Correction) ×‘×—×•×œ×” ×©××™× ×• ×‘×—×™×¨×•×?",
        "options": ["×¤×•××™ (PO)", "×•×¨×™×“ ×¤×¨×™×¤×¨×™ ××”×™×¨", "×•×¨×™×“ ××¨×›×–×™ ×‘×‘×•×œ×•×¡", "IM"],
        "correct": "×¤×•××™ (PO)",
        "explanation": "××ª×Ÿ ×¤×•××™ ×”×•× ×”××•××œ×¥ ×•×”×‘×˜×•×— ×‘×™×•×ª×¨. [cite_start]××ª×Ÿ IV ×©××•×¨ ×œ××¦×‘×™× ×—××•×¨×™× ××• ×›×©××™ ××¤×©×¨ PO[cite: 12]."
    },
    {
        "topic": "×”×—×™×™××”",
        "question": "××”×• ×”××™× ×•×Ÿ ×”××§×¡×™××œ×™ ×œ×× ×” ×‘×•×“×“×ª ×©×œ ××“×¨× ×œ×™×Ÿ ×‘×”×—×™×™××”?",
        "options": ["1 ×\"×’", "0.5 ×\"×’", "0.1 ×\"×’", "5 ×\"×’"],
        "correct": "1 ×\"×’",
        [cite_start]"explanation": "×‘×“×•××” ×œ××‘×•×’×¨×™×, ×”××™× ×•×Ÿ ×”××§×¡×™××œ×™ ×œ×× ×” ×‘×•×“×“×ª ×‘×™×œ×“×™× ×”×•× 1 ×\"×’[cite: 41]."
    },
    {
        "topic": "×˜×¨××•××”",
        "question": "××”×• ×”×™×¢×“ ×œ-CPP (×œ×—×¥ ×–×™×œ×•×— ××•×—×™) ×‘×™×œ×“×™× ×¢× ×—×‘×œ×ª ×¨××©?",
        "options": ["40-50 mmHg", "10-20 mmHg", "80-90 mmHg", "100 mmHg"],
        "correct": "40-50 mmHg",
        "explanation": "CPP = MAP - ICP. [cite_start]×‘×™×œ×“×™× ×©×•××¤×™× ×œ×¢×¨×š ×¡×‘×™×‘ 40-50 (××©×ª× ×” ××¢×˜ ×œ×¤×™ ×’×™×œ)[cite: 1133]."
    },
    {
        "topic": "×ª×¨×•×¤×•×ª",
        "question": "×‘×˜×™×¤×•×œ ×‘-SVT ×¢× ××“× ×•×–×™×Ÿ, ××” ×¢×•×©×™× ×× ×”×× ×” ×”×¨××©×•× ×” (0.1 ×\"×’/×§\"×’) ×œ× ×¢×–×¨×”?",
        "options": ["× ×•×ª× ×™× ×× ×” ×›×¤×•×œ×” (0.2 ×\"×’/×§\"×’)", "× ×•×ª× ×™× ××•×ª×” ×× ×” ×©×•×‘", "×¢×•×‘×¨×™× ×™×©×¨ ×œ×”×™×¤×•×š ×—×©××œ×™", "× ×•×ª× ×™× ×××™××•×“×•×¨×•×Ÿ"],
        "correct": "× ×•×ª× ×™× ×× ×” ×›×¤×•×œ×” (0.2 ×\"×’/×§\"×’)",
        [cite_start]"explanation": "×× ×”×× ×” ×”×¨××©×•× ×” ×œ× ××¤×§×˜×™×‘×™×ª, × ×•×ª× ×™× ×× ×” ×©× ×™×” ×©×œ 0.2 ×\"×’/×§\"×’ (××§×¡' 12 ×\"×’)[cite: 62]."
    }
]

# --- ×¤×•× ×§×¦×™×•×ª ×œ× ×™×”×•×œ ×”×“××˜×” ---
def load_data():
    if not os.path.exists(DB_FILE):
        with open(DB_FILE, 'w', encoding='utf-8') as f:
            json.dump(DEFAULT_CONTENT, f, ensure_ascii=False, indent=4)
        return DEFAULT_CONTENT
    else:
        # ×‘×“×™×§×” ×× ×™×© ×¢×“×›×•× ×™× ×‘×§×•×“ ×©×¦×¨×™×š ×œ×“×¨×•×¡ ××ª ×”×§×•×‘×¥ (×œ×¦×•×¨×š ×”×¤×™×ª×•×—)
        # ×‘×¤×¨×•×“×§×©×Ÿ × ×•×¨×™×“ ××ª ×–×” ×›×“×™ ×œ× ×œ×“×¨×•×¡ ×©×™× ×•×™×™ ××©×ª××©
        return DEFAULT_CONTENT 

def save_data(data):
    with open(DB_FILE, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=4)

# --- ×”×’×“×¨×ª ×¢××•×“ ---
st.set_page_config(
    page_title="×Ö²×—Ö¸×™×•Ö¼×ª - ×¢× ×™×©×™ ×§×•×¤×¨××Ÿ",
    page_icon="ğŸ¥",
    layout="wide",
    initial_sidebar_state="expanded"
)

# --- CSS ×¢×™×¦×•×‘ ××ª×•×§×Ÿ ---
st.markdown("""
<style>
    @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;700&display=swap');
    
    html, body, .stApp {
        font-family: 'Rubik', sans-serif;
        direction: rtl;
        text-align: right;
        background-color: #f4f6f9;
    }
    
    h1, h2, h3, h4, h5 {
        font-family: 'Rubik', sans-serif;
        text-align: right !important;
        color: #0d47a1;
        font-weight: 700;
    }

    /* ×ª×™×§×•×Ÿ ×§×¨×™×˜×™ ×œ×™×™×©×•×¨ ×˜×§×¡×˜ */
    .stMarkdown, p, div, span, ul, li {
        text-align: right !important;
        direction: rtl !important;
    }
    
    ul { margin-right: 20px !important; }

    .content-box {
        background-color: #ffffff;
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        border-top: 5px solid #0d47a1;
        margin-top: 20px;
        margin-bottom: 40px;
    }

    /* ×›×¨×˜×™×¡×™×™×ª ×©××œ×” */
    .question-card {
        background-color: #e3f2fd;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 15px;
        border-right: 5px solid #1e88e5;
    }

    .correct-box { background-color: #d4edda; padding: 15px; border-radius: 8px; border-right: 5px solid #28a745; margin-top: 10px; }
    .incorrect-box { background-color: #f8d7da; padding: 15px; border-radius: 8px; border-right: 5px solid #dc3545; margin-top: 10px; }

    #MainMenu {visibility: hidden;}
    footer {visibility: hidden;}
    
    .stButton button { width: 100%; border-radius: 8px; font-weight: bold; }
    .stTextInput input, .stTextArea textarea, .stSelectbox div { direction: rtl; text-align: right; }
</style>
""", unsafe_allow_html=True)

# --- × ×™×”×•×œ Session ---
if 'content_db' not in st.session_state: st.session_state.content_db = load_data()
if 'user_info' not in st.session_state: st.session_state.user_info = {}
if 'leaderboard' not in st.session_state: st.session_state.leaderboard = []

# --- ×¡×¨×’×œ ×¦×“ ---
with st.sidebar:
    st.image("https://img.icons8.com/color/96/nurse-male--v1.png", width=80)
    st.title("×¤×¨×•×¤×™×œ ××™×©×™")
    
    if not st.session_state.user_info:
        with st.form("login"):
            name = st.text_input("×©× ××œ×")
            email = st.text_input("××™××™×™×œ")
            if st.form_submit_button("×›× ×™×¡×” ×œ××¢×¨×›×ª"):
                st.session_state.user_info = {"name": name, "email": email}
                st.rerun()
    else:
        st.success(f"××—×•×‘×¨: {st.session_state.user_info['name']}")
        if st.button("×™×¦×™××”"):
            st.session_state.user_info = {}
            st.rerun()
    
    st.markdown("---")
    menu = st.radio("× ×™×•×•×˜:", ["ğŸ  ×“×£ ×”×‘×™×ª", "ğŸ“š ×¤×¨×•×˜×•×§×•×œ×™× ×•×—×•××¨ ×œ×™××•×“", "ğŸ“ ××‘×—×Ÿ ×™×“×¢", "âš™ï¸ × ×™×”×•×œ ×ª×•×›×Ÿ"])

# --- ×¢××•×“×™× ---

if menu == "ğŸ  ×“×£ ×”×‘×™×ª":
    st.markdown("<h1 style='text-align: center; color: #0d47a1;'>×Ö²×—Ö¸×™×•Ö¼×ª - ×¢× ×™×©×™ ×§×•×¤×¨××Ÿ</h1>", unsafe_allow_html=True)
    st.markdown("<h3 style='text-align: center; color: #546e7a; margin-top:0;'>×˜×™×¤×•×œ × ××¨×¥ ×™×œ×“×™× - PICU</h3>", unsafe_allow_html=True)
    
    st.markdown("---")
    
    col_text, col_img = st.columns([2, 1])
    with col_text:
        st.markdown("""
        <div class="content-box" style="padding: 20px;">
        <strong>×‘×¨×•×›×™× ×”×‘××™× ×œ××¢×¨×›×ª ×”×œ××™×“×” ×•×”×¤×¨×•×˜×•×§×•×œ×™×.</strong><br>
        ×”××¢×¨×›×ª ××¨×›×–×ª ××ª ×›×œ ×”××™×“×¢ ×”×§×œ×™× ×™ ×”×“×¨×•×© ×œ××©××¨×ª ×‘×˜×™×¤×•×œ × ××¨×¥:
        <ul>
            <li>ğŸš‘ <strong>×”×—×™×™××” ×•×©×•×§:</strong> ××œ×’×•×¨×™×ª××™× ×•××™× ×•× ×™× (×¢"×¤ PALS).</li>
            <li>ğŸ’Š <strong>×ª×¨×•×¤×•×ª:</strong> ××“×¨× ×œ×™×Ÿ, ××“× ×•×–×™×Ÿ, ×¡×“×¦×™×” ×•×¢×•×“.</li>
            <li>ğŸ§  <strong>×˜×¨××•××”:</strong> ×˜×™×¤×•×œ ×‘-ICP ××•×’×‘×¨ ×•×¤×¨×›×•×¡×™×.</li>
        </ul>
        </div>
        """, unsafe_allow_html=True)
    
    with col_img:
        st.info("ğŸ’¡ **×˜×™×¤ ×™×•××™:**\n×‘×—×©×“ ×œ×©×•×§ ×¡×¤×˜×™, ×™×© ×œ×ª×ª ×× ×˜×™×‘×™×•×˜×™×§×” ×ª×•×š ×©×¢×” (Golden Hour) ×•×œ× ×œ×—×›×•×ª ×œ×ª×•×¦××•×ª ××¢×‘×“×”.")
        st.warning("âš ï¸ **×‘×˜×™×—×•×ª:**\n××“× ×•×–×™×Ÿ × ×•×ª× ×™× ×‘-Push ××”×™×¨ ×‘×œ×‘×“, ×‘×‘×¨×– ×”×›×™ ×§×¨×•×‘ ×œ××˜×•×¤×œ!")

elif menu == "ğŸ“š ×¤×¨×•×˜×•×§×•×œ×™× ×•×—×•××¨ ×œ×™××•×“":
    st.title("ğŸ“š ×”×¡×¤×¨×™×™×” ×”××§×¦×•×¢×™×ª")
    
    db = st.session_state.content_db
    topics = list(db.keys())
    
    col_menu, col_content = st.columns([1, 3])
    
    with col_menu:
        st.markdown("### × ×•×©× ×¨××©×™")
        selected_topic = st.selectbox("×‘×—×¨ ×§×˜×’×•×¨×™×”:", topics, label_visibility="collapsed")
        
        st.markdown("### ×¤×¨×•×˜×•×§×•×œ")
        subtopics = list(db[selected_topic].keys())
        selected_sub = st.radio("×‘×—×¨:", subtopics)
    
    with col_content:
        data = db[selected_topic][selected_sub]
        st.markdown(f"""<div class="content-box">{data['text']}</div>""", unsafe_allow_html=True)
        if data.get('image'): st.image(data['image'], use_container_width=True)
        if data.get('video'): st.video(data['video'])

elif menu == "ğŸ“ ××‘×—×Ÿ ×™×“×¢":
    st.title("ğŸ“ ××‘×—×Ÿ ×ª×¨×’×•×œ (Question Bank)")
    
    if not st.session_state.user_info:
        st.error("× × ×œ×”×ª×—×‘×¨ ×›×“×™ ×œ×‘×¦×¢ ××‘×—×Ÿ.")
    else:
        # ×”×’×“×¨×•×ª ××‘×—×Ÿ
        num_q = st.slider("××¡×¤×¨ ×©××œ×•×ª:", 5, 20, 10)
        
        if st.button("×”×ª×—×œ ××‘×—×Ÿ ×—×“×© â–¶ï¸"):
            st.session_state.current_quiz = random.sample(ALL_QUESTIONS, min(num_q, len(ALL_QUESTIONS)))
            st.session_state.quiz_active = True
            st.session_state.quiz_answers = {}
            st.rerun()

        if st.session_state.get('quiz_active'):
            with st.form("quiz_form"):
                for i, q in enumerate(st.session_state.current_quiz):
                    st.markdown(f"""<div class="question-card"><strong>×©××œ×” {i+1}:</strong> {q['question']}</div>""", unsafe_allow_html=True)
                    
                    # ×¢×¨×‘×•×‘ ×ª×©×•×‘×•×ª (×¤×¢× ××—×ª)
                    if f"opts_{i}" not in st.session_state:
                        opts = q['options'].copy()
                        random.shuffle(opts)
                        st.session_state[f"opts_{i}"] = opts
                    
                    st.radio(f"×ª×©×•×‘×” ×œ×©××œ×” {i+1}", st.session_state[f"opts_{i}"], key=f"q_{i}", label_visibility="collapsed")
                    st.markdown("---")
                
                submitted = st.form_submit_button("×”×’×© ××‘×—×Ÿ ğŸ")
                
                if submitted:
                    score = 0
                    st.session_state.quiz_active = False
                    for i, q in enumerate(st.session_state.current_quiz):
                        user_ans = st.session_state.get(f"q_{i}")
                        st.subheader(f"×©××œ×” {i+1}")
                        if user_ans == q['correct']:
                            score += 1
                            st.markdown(f"<div class='correct-box'>âœ… <b>× ×›×•×Ÿ!</b></div>", unsafe_allow_html=True)
                        else:
                            st.markdown(f"<div class='incorrect-box'>âŒ <b>×˜×¢×™×ª.</b> ×”×ª×©×•×‘×” ×”× ×›×•× ×”: {q['correct']}</div>", unsafe_allow_html=True)
                        st.info(f"ğŸ“– **×”×¡×‘×¨:** {q['explanation']}")
                        st.markdown("---")
                    
                    final_score = int((score / len(st.session_state.current_quiz)) * 100)
                    st.metric("×¦×™×•×Ÿ ×¡×•×¤×™", f"{final_score}%")

elif menu == "âš™ï¸ × ×™×”×•×œ ×ª×•×›×Ÿ":
    st.title("×××©×§ × ×™×”×•×œ (Admin)")
    if st.session_state.user_info.get('email') == 'yishaycopp@gmail.com':
        db = st.session_state.content_db
        tab1, tab2 = st.tabs(["×¢×¨×™×›×”", "×”×•×¡×¤×”"])
        with tab1:
            main = st.selectbox("× ×•×©×:", list(db.keys()))
            sub = st.selectbox("×ª×ª-× ×•×©×:", list(db[main].keys()))
            curr = db[main][sub]
            with st.form("edit"):
                txt = st.text_area("×ª×•×›×Ÿ", value=curr['text'], height=400)
                if st.form_submit_button("×©××•×¨"):
                    st.session_state.content_db[main][sub]['text'] = txt
                    save_data(st.session_state.content_db)
                    st.success("×¢×•×“×›×Ÿ!")
                    st.rerun()
    else:
        st.error("××™×Ÿ ×”×¨×©××”.")
